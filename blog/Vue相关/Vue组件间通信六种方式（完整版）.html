<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>vue组件间通信六种方式（完整版） | 前端菜鸟的进阶之路</title>
    <meta name="description" content="编程不易，砥砺前行">
    <link rel="icon" href="/web_blog/favicon.png">
    
    <link rel="preload" href="/web_blog/assets/css/0.styles.7a36dbfb.css" as="style"><link rel="preload" href="/web_blog/assets/js/app.91c2830f.js" as="script"><link rel="preload" href="/web_blog/assets/js/2.eab7b1a3.js" as="script"><link rel="preload" href="/web_blog/assets/js/11.810ef8d7.js" as="script"><link rel="prefetch" href="/web_blog/assets/js/10.b7c51a89.js"><link rel="prefetch" href="/web_blog/assets/js/12.84690c1b.js"><link rel="prefetch" href="/web_blog/assets/js/13.014fa390.js"><link rel="prefetch" href="/web_blog/assets/js/14.b6a094b6.js"><link rel="prefetch" href="/web_blog/assets/js/15.73574f0c.js"><link rel="prefetch" href="/web_blog/assets/js/16.6d25e66c.js"><link rel="prefetch" href="/web_blog/assets/js/17.6da21962.js"><link rel="prefetch" href="/web_blog/assets/js/18.e4bbeb45.js"><link rel="prefetch" href="/web_blog/assets/js/19.9d29afb6.js"><link rel="prefetch" href="/web_blog/assets/js/20.6e359f8f.js"><link rel="prefetch" href="/web_blog/assets/js/21.b6a44bf0.js"><link rel="prefetch" href="/web_blog/assets/js/22.72395c6d.js"><link rel="prefetch" href="/web_blog/assets/js/23.3cf07315.js"><link rel="prefetch" href="/web_blog/assets/js/24.ce3af049.js"><link rel="prefetch" href="/web_blog/assets/js/25.be8464ab.js"><link rel="prefetch" href="/web_blog/assets/js/26.818e6723.js"><link rel="prefetch" href="/web_blog/assets/js/27.f604fd0e.js"><link rel="prefetch" href="/web_blog/assets/js/28.ea43a8e0.js"><link rel="prefetch" href="/web_blog/assets/js/29.6cbe154c.js"><link rel="prefetch" href="/web_blog/assets/js/3.79e8f6ea.js"><link rel="prefetch" href="/web_blog/assets/js/30.3cce892a.js"><link rel="prefetch" href="/web_blog/assets/js/31.eb02c772.js"><link rel="prefetch" href="/web_blog/assets/js/32.b6fc1c31.js"><link rel="prefetch" href="/web_blog/assets/js/33.ec19d2a3.js"><link rel="prefetch" href="/web_blog/assets/js/34.e7982556.js"><link rel="prefetch" href="/web_blog/assets/js/35.6a41dc93.js"><link rel="prefetch" href="/web_blog/assets/js/36.de0c92ff.js"><link rel="prefetch" href="/web_blog/assets/js/37.2a90e558.js"><link rel="prefetch" href="/web_blog/assets/js/38.9e70b18a.js"><link rel="prefetch" href="/web_blog/assets/js/39.89f71dfd.js"><link rel="prefetch" href="/web_blog/assets/js/4.25ef38aa.js"><link rel="prefetch" href="/web_blog/assets/js/40.e174e7e4.js"><link rel="prefetch" href="/web_blog/assets/js/41.db4885dc.js"><link rel="prefetch" href="/web_blog/assets/js/42.3319ecbf.js"><link rel="prefetch" href="/web_blog/assets/js/43.cc6ba545.js"><link rel="prefetch" href="/web_blog/assets/js/44.0b03addc.js"><link rel="prefetch" href="/web_blog/assets/js/45.7759f79c.js"><link rel="prefetch" href="/web_blog/assets/js/46.b64c0a3b.js"><link rel="prefetch" href="/web_blog/assets/js/47.ec610bc0.js"><link rel="prefetch" href="/web_blog/assets/js/48.1d911c4b.js"><link rel="prefetch" href="/web_blog/assets/js/49.6e433bb5.js"><link rel="prefetch" href="/web_blog/assets/js/5.746bcae1.js"><link rel="prefetch" href="/web_blog/assets/js/50.cae10208.js"><link rel="prefetch" href="/web_blog/assets/js/51.172c43fc.js"><link rel="prefetch" href="/web_blog/assets/js/52.2d0abb1b.js"><link rel="prefetch" href="/web_blog/assets/js/53.6601a9d1.js"><link rel="prefetch" href="/web_blog/assets/js/54.4db27d09.js"><link rel="prefetch" href="/web_blog/assets/js/55.b676ed30.js"><link rel="prefetch" href="/web_blog/assets/js/56.2f94d7d3.js"><link rel="prefetch" href="/web_blog/assets/js/57.739d9718.js"><link rel="prefetch" href="/web_blog/assets/js/58.14252a7f.js"><link rel="prefetch" href="/web_blog/assets/js/59.9c05cedd.js"><link rel="prefetch" href="/web_blog/assets/js/6.d8f4b14d.js"><link rel="prefetch" href="/web_blog/assets/js/60.10980736.js"><link rel="prefetch" href="/web_blog/assets/js/61.6dbb0bf2.js"><link rel="prefetch" href="/web_blog/assets/js/62.2b9de86f.js"><link rel="prefetch" href="/web_blog/assets/js/63.3c461591.js"><link rel="prefetch" href="/web_blog/assets/js/64.cb9c7ff9.js"><link rel="prefetch" href="/web_blog/assets/js/65.3027aedc.js"><link rel="prefetch" href="/web_blog/assets/js/66.8fa94b0b.js"><link rel="prefetch" href="/web_blog/assets/js/67.1196783a.js"><link rel="prefetch" href="/web_blog/assets/js/68.9e3adf92.js"><link rel="prefetch" href="/web_blog/assets/js/69.30b26df4.js"><link rel="prefetch" href="/web_blog/assets/js/7.bef0e458.js"><link rel="prefetch" href="/web_blog/assets/js/70.ea55f415.js"><link rel="prefetch" href="/web_blog/assets/js/71.99deb135.js"><link rel="prefetch" href="/web_blog/assets/js/72.b411f500.js"><link rel="prefetch" href="/web_blog/assets/js/73.ae212902.js"><link rel="prefetch" href="/web_blog/assets/js/74.c42cb468.js"><link rel="prefetch" href="/web_blog/assets/js/75.4841d167.js"><link rel="prefetch" href="/web_blog/assets/js/76.8152f076.js"><link rel="prefetch" href="/web_blog/assets/js/77.5650be83.js"><link rel="prefetch" href="/web_blog/assets/js/78.13e5f2de.js"><link rel="prefetch" href="/web_blog/assets/js/79.981af0a6.js"><link rel="prefetch" href="/web_blog/assets/js/8.e30cf33c.js"><link rel="prefetch" href="/web_blog/assets/js/80.79c69641.js"><link rel="prefetch" href="/web_blog/assets/js/81.acfa7b78.js"><link rel="prefetch" href="/web_blog/assets/js/82.4422108d.js"><link rel="prefetch" href="/web_blog/assets/js/83.65d9e4db.js"><link rel="prefetch" href="/web_blog/assets/js/84.b8c62118.js"><link rel="prefetch" href="/web_blog/assets/js/9.ebc19581.js">
    <link rel="stylesheet" href="/web_blog/assets/css/0.styles.7a36dbfb.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/web_blog/" class="home-link router-link-active"><!----> <span class="site-name">前端菜鸟的进阶之路</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/web_blog/" class="nav-link">首页</a></div><div class="nav-item"><a href="/web_blog/blog/" class="nav-link router-link-active">技术·博文</a></div><div class="nav-item"><a href="/web_blog/question/" class="nav-link">经典·面试</a></div> <a href="https://github.com/dancingTx/web_blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/web_blog/" class="nav-link">首页</a></div><div class="nav-item"><a href="/web_blog/blog/" class="nav-link router-link-active">技术·博文</a></div><div class="nav-item"><a href="/web_blog/question/" class="nav-link">经典·面试</a></div> <a href="https://github.com/dancingTx/web_blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JS知识汇总</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>JS框架-Vue篇</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/web_blog/blog/Vue相关/Vue组件间通信六种方式（完整版）.html" class="active sidebar-link">vue组件间通信六种方式（完整版）</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web_blog/blog/Vue相关/Vue组件间通信六种方式（完整版）.html#前言" class="sidebar-link">前言</a></li><li class="sidebar-sub-header"><a href="/web_blog/blog/Vue相关/Vue组件间通信六种方式（完整版）.html#一、props-emit" class="sidebar-link">一、props/$emit</a></li><li class="sidebar-sub-header"><a href="/web_blog/blog/Vue相关/Vue组件间通信六种方式（完整版）.html#二、-emit-on" class="sidebar-link">二、$emit/$on</a></li><li class="sidebar-sub-header"><a href="/web_blog/blog/Vue相关/Vue组件间通信六种方式（完整版）.html#三、vuex" class="sidebar-link">三、vuex</a></li><li class="sidebar-sub-header"><a href="/web_blog/blog/Vue相关/Vue组件间通信六种方式（完整版）.html#四、-attrs-listeners" class="sidebar-link">四、$attrs/$listeners</a></li><li class="sidebar-sub-header"><a href="/web_blog/blog/Vue相关/Vue组件间通信六种方式（完整版）.html#五、provide-inject" class="sidebar-link">五、provide/inject</a></li><li class="sidebar-sub-header"><a href="/web_blog/blog/Vue相关/Vue组件间通信六种方式（完整版）.html#六、-parent-children与ref" class="sidebar-link">六、$parent/$children与ref</a></li><li class="sidebar-sub-header"><a href="/web_blog/blog/Vue相关/Vue组件间通信六种方式（完整版）.html#总结" class="sidebar-link">总结</a></li><li class="sidebar-sub-header"><a href="/web_blog/blog/Vue相关/Vue组件间通信六种方式（完整版）.html#原文链接" class="sidebar-link">原文链接</a></li></ul></li><li><a href="/web_blog/blog/Vue相关/Vuex用法详解.html" class="sidebar-link">Vuex用法详解</a></li><li><a href="/web_blog/blog/Vue相关/Vue官方推荐的风格指南.html" class="sidebar-link">Vue官方推荐的风格指南</a></li><li><a href="/web_blog/blog/Vue相关/Vue简易实现.html" class="sidebar-link">Vue的简易实现</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JS框架-React篇</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Node</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>NPM</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端自动化及工具</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>H5移动端</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>H5中的WebAPI</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>网络协议</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>软技能</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据结构</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/web_blog/blog/声明.html" class="sidebar-link">声明</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="vue组件间通信六种方式（完整版）"><a href="#vue组件间通信六种方式（完整版）" aria-hidden="true" class="header-anchor">#</a> vue组件间通信六种方式（完整版）</h1> <h2 id="前言"><a href="#前言" aria-hidden="true" class="header-anchor">#</a> 前言</h2> <p>组件是vue.js中最强大也是最具特色的功能之一，而组件实例的作用域也是相互独立的，这就意味着不同的组件之间数据是无法共享的。一般来说，组件间可以有以下几种关系：</p> <p><img src="/web_blog/assets/img/3174701-7a15ec352b4e7d84.4a17509d.png" alt=""></p> <p>如上图所示，A和B、B和C、B和D都是父子关系，C和D是兄弟关系，A和C、D是隔代关系(可能隔多代)。</p> <p>针对不同的使用场景，如何选择行之有效的通信方式?这是我们所要探讨的主题。本文总结了Vue组件间几种通信方式，如<code>props</code>、<code>$emit/$on</code>、<code>vuex</code>、<code>$parent/$children</code>、<code>$attrs/$listeners</code>和<code>provide/inject</code>，以通俗易懂的实例讲述这其中的差别及使用场景。</p> <h2 id="一、props-emit"><a href="#一、props-emit" aria-hidden="true" class="header-anchor">#</a> 一、props/$emit</h2> <p>父组件A通过props的方式向子组件B传递，B to A 通过在 B 组件中 $emit，A 组件中 v-on 的方式实现。</p> <p><strong>1.父组件向子组件传值</strong></p> <p>接下来，通过一个实例，说明父组件如何向子组件传递值：在子组件Users.vue中如何获取父组件App.vue中的数据<code>users:['hery','bucky','emily']</code></p> <div class="language-vue line-numbers-mode"><pre class="language-vue"><code>// App.vue 父组件
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>app<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>
        // 前者自定义名称便于子组件调用，后者要传递数据名
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Users</span> <span class="token attr-name">:users</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>users<span class="token punctuation">'</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
	<span class="token keyword">import</span> Users <span class="token keyword">from</span> <span class="token string">'./components/Users'</span>
    <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
        name<span class="token punctuation">:</span><span class="token string">'App'</span><span class="token punctuation">,</span>
        <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token punctuation">{</span>
                users<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'hery'</span><span class="token punctuation">,</span><span class="token string">'bucky'</span><span class="token punctuation">,</span><span class="token string">'emily'</span><span class="token punctuation">]</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        components<span class="token punctuation">:</span><span class="token punctuation">{</span>
            Users
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><div class="language-vue line-numbers-mode"><pre class="language-vue"><code>// Users 子组件
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>hello<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
            // 遍历父组件中传递过来的值，然后渲染到页面上
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>user of users<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>{{user}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
    	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
	<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
        name<span class="token punctuation">:</span><span class="token string">'Users'</span><span class="token punctuation">,</span>
        props<span class="token punctuation">:</span><span class="token punctuation">{</span>
            <span class="token comment">// 该名字为父组件中传递值所定义的名称</span>
            <span class="token comment">// props 中的属性尽量写全，避免用数组直接接收名称</span>
            users<span class="token punctuation">:</span><span class="token punctuation">{</span>
                type<span class="token punctuation">:</span>Array<span class="token punctuation">,</span>
                require<span class="token punctuation">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>
                <span class="token keyword">default</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p><strong>总结:父组件通过props向下传递数据给子组件。</strong></p> <p><strong>注：组件中的数据一共有三种形式：data，props，computed</strong></p> <p><strong>2.子组件向父组件传值(通过事件形式)</strong></p> <p>接下来通过一个实例，说明子组件如何向父组件传递值：当我们点击<code>Vue.js Demo</code>后，子组件向父组件传递值，文字由原来的&quot;传递的是一个值&quot;变成“子向父组件传值”，实现子组件向父组件值得传递。</p> <p><img src="/web_blog/assets/img/3174701-8d31dfc061d39fad.48c11c59.png" alt=""></p> <div class="language-vue line-numbers-mode"><pre class="language-vue"><code>// 子组件
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>header</span><span class="token punctuation">&gt;</span></span>
        // 绑定点击事件
    	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>changeTitle<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>{{title}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>header</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
	<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
        name<span class="token punctuation">:</span><span class="token string">'app-header'</span><span class="token punctuation">,</span>
        <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token punctuation">{</span>
                title<span class="token punctuation">:</span> <span class="token string">'Vue.js Demo'</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        methods<span class="token punctuation">:</span><span class="token punctuation">{</span>
            <span class="token function">changeTitle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token comment">// 自定义事件 第一个参数为传递名称，第二个参数为传递值，是一个参数列表</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'titleChanged'</span><span class="token punctuation">,</span><span class="token string">'子向父组件传值'</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><div class="language-vue line-numbers-mode"><pre class="language-vue"><code>// 父组件
// 如果两标签间无其余值，建议采用自闭合标签
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>app<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>
        // 此处的名称与子组件中自定义名称一致
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Header</span> <span class="token attr-name">@titleChanged</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>updateTitle<span class="token punctuation">'</span></span> <span class="token punctuation">/&gt;</span></span>
        // updateTitle($event)接受传递过来的文字
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>{{title}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token comment">// Header 可能与html自带标签冲突，建议加个前缀</span>
	<span class="token keyword">import</span> Header <span class="token keyword">from</span> <span class="token string">'./components/Header'</span>
    <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
        name<span class="token punctuation">:</span><span class="token string">'App'</span><span class="token punctuation">,</span>
        <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token punctuation">{</span>
                title<span class="token punctuation">:</span><span class="token string">'传递的是一个值'</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token function">updateTitle</span><span class="token punctuation">(</span><span class="token parameter">title</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>title <span class="token operator">=</span> title
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        components<span class="token punctuation">:</span><span class="token punctuation">{</span>
            Header
		<span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><p><strong>总结：子组件通过events给父组件发送消息，实际上就是子组件把自己的数据发送给父组件。</strong></p> <h2 id="二、-emit-on"><a href="#二、-emit-on" aria-hidden="true" class="header-anchor">#</a> 二、$emit/$on</h2> <p>__这种方法通过一个空的Vue实例作为中央时间总线(事件中心)，用它来触发事件以及监听事件，巧妙而又轻量的实现了任何组件间的通信，包括父子、兄弟、跨级。__当我们的项目较大时，可以选择更优解——状态管理机制vuex。</p> <p><strong>具体实现方式</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> Event <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
Event<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span>eventName<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token operator">...</span>args<span class="token punctuation">]</span><span class="token punctuation">)</span>
Event<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span>eventName<span class="token punctuation">,</span><span class="token parameter">data</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>具体实例</strong></p> <p>假设兄弟组件有三个，分别是A、B、C组件，C组件如何获取A或者B组件的数据？</p> <div class="language-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>itany<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-a</span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-b</span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-c</span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>a<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span><span class="token punctuation">&gt;</span></span>A组件:{{name}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>send<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>将数据发送给C组件<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>b<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span><span class="token punctuation">&gt;</span></span>B组件:{{age}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>send<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>将数据发送给C组件<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>c<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span><span class="token punctuation">&gt;</span></span>C组件:{{name}}|{{age}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
	<span class="token keyword">let</span> Event <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//定义一个空的Vue实例</span>
    <span class="token keyword">let</span> <span class="token constant">A</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
        template<span class="token punctuation">:</span> <span class="token string">'#a'</span><span class="token punctuation">,</span>
        <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token punctuation">{</span>
                name<span class="token punctuation">:</span><span class="token string">'tom'</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                Event<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'data-a'</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">let</span> <span class="token constant">B</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
        template<span class="token punctuation">:</span> <span class="token string">'#b'</span><span class="token punctuation">,</span>
        <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token punctuation">{</span>
                age<span class="token punctuation">:</span> <span class="token number">10</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        methods<span class="token punctuation">:</span><span class="token punctuation">{</span>
            <span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                Event<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'data-b'</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>age<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">let</span> <span class="token constant">C</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
        template<span class="token punctuation">:</span><span class="token string">'#c'</span><span class="token punctuation">,</span>
        <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token punctuation">{</span>
                name<span class="token punctuation">:</span><span class="token string">''</span><span class="token punctuation">,</span>
                age<span class="token punctuation">:</span><span class="token string">''</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token comment">// 在模板编译完成后执行</span>
        <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            Event<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">'data-a'</span><span class="token punctuation">,</span><span class="token parameter">name</span><span class="token operator">=&gt;</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">)</span>
            Event<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">'data-b'</span><span class="token punctuation">,</span><span class="token parameter">age</span><span class="token operator">=&gt;</span><span class="token keyword">this</span><span class="token punctuation">.</span>age<span class="token operator">=</span>age<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">let</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        el<span class="token punctuation">:</span><span class="token string">'#itany'</span><span class="token punctuation">,</span>
        components<span class="token punctuation">:</span><span class="token punctuation">{</span>
            <span class="token string">'my-a'</span><span class="token punctuation">:</span><span class="token constant">A</span><span class="token punctuation">,</span>
            <span class="token string">'my-b'</span><span class="token punctuation">:</span><span class="token constant">B</span><span class="token punctuation">,</span>
            <span class="token string">'my-c'</span><span class="token punctuation">:</span><span class="token constant">C</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br></div></div><p><img src="/web_blog/assets/img/3174701-6677501da9006ed2.dc855413.gif" alt=""></p> <p>$on 监听了自定义事件 data-a 和 data-b ，因为有时不确定何时会触发事件，一般会在 mounted 或 created 钩子中进行监听。</p> <h2 id="三、vuex"><a href="#三、vuex" aria-hidden="true" class="header-anchor">#</a> 三、vuex</h2> <p><img src="/web_blog/assets/img/3174701-e62ba449a0c2e7ac.4d3f4c07.png" alt=""></p> <p><strong>1.简要介绍Vuex原理</strong></p> <p>Vuex 实现了一个单项数据流，在全局中拥有一个 state 来存放数据源，当组件要更改 state 中的数据时，必须通过 Mutations 进行派发，Mutations 同时提供了订阅者模式供外部插件调用获取 state 数据的更新。而当存在异步操作(常见于调用后端接口异步获取更新数据)或批量的同步操作时，需要通过 Actions 调用，但是 Actions 无法直接修改 state ，所以还是需要 commit 给 Mutations 进行 state 数据的修改。最后，根据 state 的变化，动态的将数据渲染到视图中。</p> <p><strong>2.简要介绍各模块在流程中的功能</strong></p> <ul><li>Vue Components: Vue组件。HTML页面上，负责接收用户操作等交互行为，执行 dispatch 方法触发对应的 action 进行回应。</li> <li>dispatch： 操作行为触发方法，是唯一能执行 action 的方法。</li> <li>actions： __操作行为处理模块，由组件中的<code>$state.dispatch(actionName,[...args])</code>来进行派发。然后由 commit() 来触发 mutation 的调用，进而更新 state。__负责处理 Vue Components 接收到的所有交互行为。包含同步/异步操作，支持多个同名方法，按照注册的顺序依次触发。像后台 API 请求的操作就在该模块中进行，包括触发其他 action 以及提交 mutation 的操作。该模块提供了 Promise 的封装，以支持 action 的链式触发。</li> <li>commit： 状态改变提交操作方法。对 mutation 进行提交，是唯一能执行 mutation 的方法。</li> <li>mutations： <strong>状态改变操作方法，由actions中的<code>commit(mutationName)</code>来触发</strong>。是 Vuex 修改 state 的唯一推荐方法。该方法只能进行同步操作，且方法名只能全局唯一。操作之中会有一些 hook 暴露出来，以进行 state 的监控等。</li> <li>state：状态页面管理容器对象。 集中储存 Vue Components 中 data 对象的零散数据，全局唯一，以进行统一的状态管理。页面显示所需的数据从该对象中进行读取，利用 Vue 的细粒度数据响应机制来进行高效的状态更新。</li> <li>getters： state 对象读取方法。图中并没有单独列出该模块， 应该被包含在了 render 中， Vue Components 通过该方法读取全局 state 对象。</li></ul> <p><strong>3.Vuex与localStorage</strong></p> <p>Vuex 是 Vue 的状态管理器，存储的数据是响应式的。但是并不会被保存起来，刷新后会回到初始状态，__具体做法应该是在 Vuex 里的数据改变的时候把数据拷贝一份保存在 localStorage 里面，刷新以后，如果 localStorage 中保存有数据，将其取出后替换 store 中的 state 。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> defaultCity <span class="token operator">=</span> <span class="token string">'上海'</span>
<span class="token comment">// 若用户关闭本地储存功能， 在此处增加错误处理</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>defaultCity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        defaultCity <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">'defaultCity'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>store</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    state<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        city<span class="token punctuation">:</span>defaultCity
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    mutations<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token function">changeCity</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span>city</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            state<span class="token punctuation">.</span>city <span class="token operator">=</span> city
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                window<span class="token punctuation">.</span>localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">'defaultCity'</span><span class="token punctuation">,</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>city<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token comment">// 数据改变是将数据拷贝一份存入localStorage里面</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>这里需要注意：由于 Vuex 里，我们保存的状态，都是数组，而 localStorage 只支持字符串，所以需要通过JSON转换：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>subscribeList<span class="token punctuation">)</span> <span class="token comment">// array-&gt;string </span>
<span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">'subscribeList'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// string -&gt; array</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="四、-attrs-listeners"><a href="#四、-attrs-listeners" aria-hidden="true" class="header-anchor">#</a> 四、$attrs/$listeners</h2> <p><strong>1.简介</strong></p> <p>多级组件嵌套需要传递数据时，通常使用的方法就是通过 Vuex。但是如果仅仅是传递数据，而不做中间处理的情况，使用 Vuex 来处理，未免有点大材小用。为此 Vue2.4 版本中提供了另外一种方法——<code>$attrs/$listeners</code></p> <ul><li><code>$attrs</code>：包含了父作用域中不被 props 所识别(且获取)的特性绑定(class和style除外)。当一个组件没有声明任何 props 时，这里会包含所有父作用域的绑定(class 和 style 除外)，并且可以通过 v-bind:'$attrs' 传入内部组件。通常配合 interitAttrs 选项一起使用。</li> <li><code>$listeners</code>：包含了父作用域中的(不含.native 修饰器) v-on 事件监听器。它可以通过 v-on='$listeners' 传入内部组件。</li></ul> <p>接下来看一个跨级通信的实例：</p> <div class="language-vue line-numbers-mode"><pre class="language-vue"><code>// index.vue
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>浪里行舟<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>child-com1</span>
      <span class="token attr-name">:foo</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>foo<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">:boo</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>boo<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">:coo</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>coo<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">:doo</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>doo<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>前端工匠<span class="token punctuation">&quot;</span></span>
    <span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>child-com1</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">const</span> <span class="token function-variable function">childCom1</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&quot;./childCom1.vue&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  components<span class="token punctuation">:</span> <span class="token punctuation">{</span> childCom1 <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      foo<span class="token punctuation">:</span> <span class="token string">&quot;Javascript&quot;</span><span class="token punctuation">,</span>
      boo<span class="token punctuation">:</span> <span class="token string">&quot;Html&quot;</span><span class="token punctuation">,</span>
      coo<span class="token punctuation">:</span> <span class="token string">&quot;CSS&quot;</span><span class="token punctuation">,</span>
      doo<span class="token punctuation">:</span> <span class="token string">&quot;Vue&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><div class="language-vue line-numbers-mode"><pre class="language-vue"><code>// childCom1.vue
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>border<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>foo: {{ foo }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>childCom1的$attrs: {{ $attrs }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>child-com2</span> <span class="token attr-name">v-bind</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>$attrs<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>child-com2</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">const</span> <span class="token function-variable function">childCom2</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&quot;./childCom2.vue&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  components<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    childCom2
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  inheritAttrs<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 可以关闭自动挂载到组件根元素上的没有在props声明的属性</span>
  props<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    foo<span class="token punctuation">:</span> String <span class="token comment">// foo作为props属性绑定</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$attrs<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// { &quot;boo&quot;: &quot;Html&quot;, &quot;coo&quot;: &quot;CSS&quot;, &quot;doo&quot;: &quot;Vue&quot;, &quot;title&quot;: &quot;前端工匠&quot; }</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><div class="language-vue line-numbers-mode"><pre class="language-vue"><code>// childCom2.vue
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>border<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>boo: {{ boo }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>childCom2: {{ $attrs }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>child-com3</span> <span class="token attr-name">v-bind</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>$attrs<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>child-com3</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">const</span> <span class="token function-variable function">childCom3</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&quot;./childCom3.vue&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  components<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    childCom3
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  inheritAttrs<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  props<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    boo<span class="token punctuation">:</span> String
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$attrs<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// {&quot;coo&quot;: &quot;CSS&quot;, &quot;doo&quot;: &quot;Vue&quot;, &quot;title&quot;: &quot;前端工匠&quot; }</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><div class="language-vue line-numbers-mode"><pre class="language-vue"><code>// childCom3.vue
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>border<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>childCom3: {{ $attrs }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  props<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    coo<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
    title<span class="token punctuation">:</span> String
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAjkAAADjCAMAAABQD/U/AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAABmUExURf///+v//63q////0o3S/yt1tiuX0iw+UP8AAOu2d/7/6f/SmWm26K12UP/qttCXUCYmJos+UND//ys8mWk/bSs6dYs+e/zQlriDgWlRo4EmJsCBJs7+3+uzbGmX0qqznn+2tun+0PFV/3sAAA6QSURBVHja7J0Je6o6EIatYrgswqm1Ll1O2///J+9sgQSC2h57T69+7/NYC0LI8jEzwWY6mwEAAAAAgKujeapPH7Rz6CigPHdaeH6cnzp48fSwTivqV42uvC3K6ml5541Ob1Cef8XoJ+UzCWfxNNjrPwA356WWd7uhSEwJu1+ZmhrVyGvKKjVPocQydOhNBTi7bsTL52nlJIUTxUc7KOfGOEs5LJzFdp1UzmsN5UA5E3FOcyDRvI6locrRCBnKuSHNiAc6M85Jztx1n06uoJwbmlu9/qK51XlxDn0YB9N8qleTSBDKuSUWMrc6SzmBr1oEk3lEyIhzjsU5Mv8eKuf11xg8Zr4p5ZwR5zRPG9gcEPBcy4hrrFw+u6QtEvnsUsqRnZiV33Cc4zXz6tLKof1J5cjzwVc1VVDOLcHeRkZcjE75/Di/i7yXMnxc0ytHHdtOpAPl3BJsM2TE2eg08ZfhAyWklON/waz81pCvuXXEOQT2luRs5byGf18B5dyUs3I24rt69Ij4mHKcvYdGCsq5JWfFNoNGXBRkf6LznHhKwyYmEIbGNWSxIq28nv7jMHA1zkqnRuamSAlH/rjPlCOP/9TUlEX/J4V4CnhbPLNkAltB2sHwAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgZ1Dl+ZFFMlW84PM4bb9iosDiiaunPZo5/VPKCYByrp1ylecP68W9Gh6yP7zqqujlwsppNrJbLAopwjZnLZ85k8161hxWuaMjCke7s1mR51+UHPg/2ZzFvb4qEkQVL+4l5TSbjAS2vKtIJ+Uq85ssL3ot7jM6l/bW4q0KVhEdAZtzE8oRG1M9vKzqOFgJvJVpRBIi66YZJntrNnNVDm+K7UHP3oByRCzN4eU+G0Uoohx2ZvTuBaGb9PNx3gmtU44zXUE5UA5JRM0SWyV2TbbJMdLDGsqBtxp5Kx59Uo6YHT5kcf9OzqrbFOuTwVshQh5FyBwSkwj4rZKpUpuL5dFNtUJrjn7KVd0phyZW/DuUcxvPcyZm5W1ugsmXkgKwkoNsk+fzvJNn5S6wOSueldM2/k8a+AwFHuMAKAdAOQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA+ByS7qhcZba5n6NLvpVKlpwWdf/TsnTwekMPJ13ot/L6uyrTLYR0wSpr3p8fyzq02M67n81BD+NVksEZhQs0NcCWTlbLclXr5VJX6JeuyIFWGi/rHSzabTbzwvXl0IHV1NJMKamvopzES0NzObn1ja5yWfkZldTXSFaCDrpxeP2dLU9u3akj15Um2LC3yfb70iyjS0n3aSVn+QHo85a1WaLJi/vH+XcoZxauz5ecRFSBqf7XSlSqcBH4w7rZZPt5nGJvUjl22M9QTqXLgGurFjdaTqf9f6AczYsg6ZvOUY5Zj2PKCQ2JrIx3p5RTSTqyvsmXWiVfyG0lK6jrzuZwfjNqWGE2sO4Wabf1it5bPTZ/575j29kcdpKaZsvtV2/FLXRSEJe82L6puqgNvst8S+iUNlvcv+mNHq8Kp56rOjMoB/bK4bI/tm8b+inZb0Q5ZecrOSPX4c7a5+vPm9KNUpLvSTrJKmVZCfTG0QFsnZXUjSW3mJrCrWf/4LPw1HFRelYhkqMGcGGNncE9PKzpLpcsLFVuyVgqsYDj9g9uPr5dd52MRsopcmt3cPKF1h9Wem9x1oZK0+dxvhjO+5BnwX3pE0O0/KI+4tPe7ppOORu5qUg5tEt6pOXbIc+8zVncO61yUG1ffPN7xt3N1+T8NlEminK/rrpKyIGxzVnc8ylacbp0VdMJsy7eohOsfb7+3DJ6SUld2/ik3qiooZUu9nZdSvIfS42opuWKExlw81yfP2N0fZERt9SUI41mpzSuaeStuD58eKL9IhPSmlmpUVLNSDkuOvmCyunuO8kok6lyZCdthfbUktHI3cB2Q2Ob3ubccajG6dOCdIx8fqecbFTlQJgWVrHVmM7V5s/SO8wrJ+vcfsJ7+Gv4+nfjeMxdxwGPS/tprW2lWSl9rdcTLtkysMgZapvnKQ8aKEfvjyLZ/sysFCuHTNfq/T6PjE5aOcmm/gFeHJFyPrR/A+UsfAIsH5uFyvGRvLMoWX2ZGMpYOZZSLYhLBsE2HXUk41bQc4HNybSrJpRjTfD110Pa+lR3UpivMihXJqJhbD/vYxB6t1qvZ+lD+WNTTiFj/HhKOQtVw/SdY8ppDur0Kjdhc/LuPkv3+/cop785jyrH2cSqtWhgPxf3pxFDqBxLqeYbEHX031bO0GD0bU/dop9QDkf/23mvnMkbfqCcbNJLhDZnsX3Zvvi5eDZSjrSiHD4mSZq8i3or32lsPENvNaEc/0Ze+8A5+GZj5fRSHdmc873VZ5RztreyenkPNOtHL+WEPuGtqGY+aVxQ+uykt6onRyy0OeSrDjw1c9blA+VIzrKhci5jc3wkFilHkgVThOxn5RZdWgR9RDmVBNc8K+eWUxvHcU7Qc4M4h7vBHctm/BXl+PYNIuRUR+is3FmjJcmb9HtyDIt0hJw262IMZNahZ6Q1NoiQ5TlSfcrmzNqNO6Ic2TVUzqVyu1g4EimHd77LHRc+FPNpXyfiHPMudgY/EMxWTp72Fbm/2XWmPZiVmwVNzsrHbQ2UQ2W/JJQTW3pt32BWPr6+PsLsA2N9Rhn4gMFwp2flievPTKl85Pt2Lkf6kqIjeYrYOv8m9a6n2q+doOkx8+W0ck49u/v7z8LJ5nCP6FCf/e1D+02PxKvsW4rdr39CTSX+lP8/wMriHyojUVz4lNBF3z64H6icP/y+6/KU+29JB9k/0vnpNT3V7f//TKtI+fkXuPT3VgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/iv+AeAr4NYBAAAAAAAAdExnhFA0V4YlTgi50KJ9AOWAW1NOOs2BTy7QKUcSjQU5EKGcm1dOMvnghM0JciBCOfBWR9M5FV2yq8LNwhyIUM6tK+dECrmBzelzA0E5UA6UA77DW0E5YEI5x5MPQjlgyludOSuXJFBQDgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPDjKXjB4KzN+p/desG8w83KVb+VZ9feKX5hZLG887/KGu6KGm+LKse08WfUY9xPi62uBU/2vetTcZWrTNZrdpdoNr6nqeBcF2z2JVXLUpaWSx0HxY4PXLmoWUEds6qrs55WOL/GOEgT1l8tqLXssqQIi+2alURbleuKtl/280STq3yqU65DOcGvrJyWe7l4TC+3bakrwlG0IfmkcrpLyHWbTW2apf1/oByrSzs8NK0csx5HlRMaEjIsIpvjypFkYn2Tu8+vRzOaIm2v7VSbQzsf6Lb1/e+61d2FI3vACdasn6nzuy62waNd3JlmkAp9YwvO3e2oW/uebA53/SX09IKzdInpus+sJD+Wd+QhqBqPezZH0WJzPdCuLwdyDgMtgwsr7AxnF+2VUzke3w/NGfchx0qJUkgnVRebEW1Oviw6GY2U03a2ujs5kOJVwD1Lr2ajWSNUOc0mozFxQdIRn1Gi4BxZ9Ik3TKE7sJEr9+tKCuJXQd1HL05Kwa+qpk/98ft58zu4ROVjgnJllkJL8gr/PWPRschHKeDGB84secraK4ffeezkon78taaRt+LzOGWcFOJrxrXWWOZxXpmVGpmQWDl1dPI1KseGWxSgN77PWdO60GDbQPA7H+u7KUhoE3kRsyvy5p1HKslE2J2FRjcWcCZNu5TDgpxIqhO7Xy7cK6fQBE7rlAcNlCP5noJxjzyiWikpq60X27dNHhqdCeUkm3oNtEEo2SlHdhahcixzliqH+t+6qQ0i5KhnTCX61tYy0joqR7uzVR8kPjQVmKtiyJNMJPKKG8ZX98ppZYwfTimnUTWklBPZnMpxiOynW2lvlfs7IXFnXblygrs5rZxYONns88oZGYwufk3eop9QDhtIN+uV4yatbqycqeQ7sc1pDh+HD5uL2wQiVI7FgAOdVlclnWPeyg9j7x4i5XTxSGKoz/VW/SXsdDooiMu/7q3oqu8yfN5bTY5a7K0m83fHNod8leOpWV0tP7Zj5XB4N1LOldkcixxj5fBOjpBtypxnfYQcKGc45S2GppmVFkfIKaPnL6ERcutMkUmdsbwSEXJaEeIqNGGcnpEeu0GEzKlxU/KJbU652tTTynmRXQPlXFucI7NyN7A5vHMpA1344MDPynvlWEiQDWflfcjCQxrPykN7FAbG/ZPA2j8J7BxhVCxV4+FtNCtP3tM6MZeIaSdxfR91VGG802weXjRnnDi/to/OYytqyvHusc2X0zYnbQSvTDmX45vcePl2+WL3688b5+2cZbvmeyCTHyojVlz0lLCOvn2ooZy/ppzq8h3eP9L5j+MCkDYOqxx9M30DXOn3VgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAziEH4Cvg1gEAAAAAAOCq+VIuwn/bu2PdhGEgAMMVA2qwqkigDt3o+78k8bkHNmdDcBQ1nP5vYUlYOMUOKD9DWRIxLUL7+LkNug2nRvrIe8PP2+R8vNAijB963qowLcI5k/Obnq606QK/DT8/M9PZIpTLRIgPc7dahGdpc6XcQTq/6A+mA1N1Y9xfo4HxDKk/Om34ebGwRVgpyqXC3zQQh6/vnSZW9HybApR3ynKTMijj3m/Dz4tFLcKh2AOZFqGWmvQdQ23HlELGf9XT6TXcJ8SYnG1a1iLMtzK2Rag7nul1bEYkdcG7BrzySpuZSLzF5DxtEebjUmkRzpucuFb+HB+l3wKj82ar1eMWoXYGq9ec+auV7Lqz3KQ9iGvOZnfInS1CCXJnn/N9i7C2Q67f3cW1SaOBkiwMrSIvtnVX3tUi1D8BaLcI7V158cXP7VA5UaOB8cjyz06YHOfWahEyOUxO93oK19ZpEfK7FQAAAAAAAAAAAAAAAABgXQTv0NcJ/AR6cNEFAAAAAOC/XAAETV4/Kt0UNAAAAABJRU5ErkJggg==" alt=""></p> <p>如上图所示 <code>$attrs</code>表示没有继承数据的对象，格式为<code>{属性名：属性值}</code>。Vue2.4 中提供了<code>$attrs</code>，<code>$listeners</code>来传递数据与事件，跨级组件之间的通讯变得更加方便。</p> <p>简单来说：<code>$attrs</code>与<code>$listeners</code>是两个对象，<code>$attrs</code>里存放的是父组件中绑定的非 props 属性，<code>$listeners</code>里存放的是父组件中绑定的非原生事件。</p> <h2 id="五、provide-inject"><a href="#五、provide-inject" aria-hidden="true" class="header-anchor">#</a> 五、provide/inject</h2> <p><strong>1.简介</strong></p> <p>Vue2.2.0 新增 API ，这对选项需要一起使用，__以允许一个祖先组件向其所有子孙后代注入一个依赖，不论组件层次有多深，并在其上下文关系成立的时间里始终生效。__一言而蔽之：祖先组件中通过 provide 来提供变量，然后在子孙组件中通过 inject 来注入变量。</p> <p><strong>provide/inject API 主要解决了跨级组件间的通信问题，但是它的使用场景，主要是子组件获取上级组件的状态，跨级组件间建里了一种主动提供与依赖注入的关系。</strong></p> <p><strong>2.举个例子</strong></p> <p>假设有两个组件：A.vue 和 B.vue，B 是 A 的子组件</p> <div class="language-vue line-numbers-mode"><pre class="language-vue"><code>// A.vue
export default {
	provide: {
		name: 'xxx'
	}
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language-vue line-numbers-mode"><pre class="language-vue"><code>// B.vue
export default {
	inject:['name'],
	mounted() {
		console.log(this.name) // xxx
	}
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>可以看到，在 A.vue 里，我们设置了一个 <code>provide:name</code>， 值为 <code>xxx</code>，它的作用就是将 <code>name</code>这个变量提供给它的所有子组件。而在 B.vue 中，通过<code>inejct</code>注入了从 A 组件中提供的 <code>name</code>变量，那么在组件 B 中，就可以直接通过 <code>this.name</code>访问到这个变量了，它的值也是 <code>xxx</code>。这就是 <code>provide/iinject</code>最核心的用法。</p> <p>需要注意的是：<strong>provide 和 inject 绑定并不是可响应的。这是刻意为之。然而，如果你传入了一个可监听的对象，那么其对象的属性还是可响应的</strong>——vue官方文档</p> <p>所以，上面的 A.vue 的 <code>name</code>如果改变了，B.vue 中的 <code>this.name</code>并不会发生改变，依然是<code>xxx</code>。</p> <p><strong>3.provide与inject怎么实现 数据响应式</strong></p> <p>一般来说，有两种方法：</p> <ul><li>provide 祖先组件的实例，然后再子孙组件中注入依赖，这样就可以在子孙组件中直接修改祖先组件的实例属性不过这种方法的缺点就是这个实例上挂载了很多没有必要的东西如props，methods。</li> <li>使用vue2.6最新 API Vue.observable 优化响应式 provide(推荐)</li></ul> <p>我们来看一个实例：孙组件D、E和F获取 A 组件传递过来的 color 值，并能实现数据响应式变化，即 A 组件的 color 变化后，组件 D、E、F 不会跟着变(核心代码如下)</p> <p><img src="/web_blog/assets/img/3174701-38ef418e343f6b76.b650a238.png" alt=""></p> <div class="language-vue line-numbers-mode"><pre class="language-vue"><code>// A 组件 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>A 组件<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>() =&gt; changeColor()<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>改变color<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ChildrenB</span> <span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ChildrenC</span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
......
  data() {
    return {
      color: &quot;blue&quot;
    };
  },
  // provide() {
  //   return {
  //     theme: {
  //       color: this.color //这种方式绑定的数据并不是可响应的
  //     } // 即A组件的color变化后，组件D、E、F不会跟着变
  //   };
  // },
  provide() {
    return {
      theme: this//方法一：提供祖先组件的实例
    };
  },
  methods: {
    changeColor(color) {
      if (color) {
        this.color = color;
      } else {
        this.color = this.color === &quot;blue&quot; ? &quot;red&quot; : &quot;blue&quot;;
      }
    }
  }
  // 方法二:使用2.6最新API Vue.observable 优化响应式 provide
  // provide() {
  //   this.theme = Vue.observable({
  //     color: &quot;blue&quot;
  //   });
  //   return {
  //     theme: this.theme
  //   };
  // },
  // methods: {
  //   changeColor(color) {
  //     if (color) {
  //       this.theme.color = color;
  //     } else {
  //       this.theme.color = this.theme.color === &quot;blue&quot; ? &quot;red&quot; : &quot;blue&quot;;
  //     }
  //   }
  // }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br></div></div><div class="language-vue line-numbers-mode"><pre class="language-vue"><code>// F 组件 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">functional</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>border2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span> <span class="token attr-name">:</span><span class="token style-attr language-css"><span class="token attr-name"><span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token punctuation">{</span> <span class="token property">color</span><span class="token punctuation">:</span> injections.theme.color <span class="token punctuation">}</span></span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>F 组件<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  inject<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    theme<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token comment">//函数式组件取值不一样</span>
      <span class="token function-variable function">default</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>虽说 provide 和 inject 主要为高阶插件/组件库提供用例，但如果你能在业务中熟练运用，可以达到事半功倍的效果！</p> <h2 id="六、-parent-children与ref"><a href="#六、-parent-children与ref" aria-hidden="true" class="header-anchor">#</a> 六、$parent/$children与ref</h2> <ul><li><code>ref</code>：如果在普通的 DOM 元素上使用，引用指向的就是 DOM 元素；如果用在子组件上，引用就指向组件实例</li> <li><code>$parent/$children</code>：访问父/子实例</li></ul> <p>需要注意的是：这两种都是直接得到组件实例，使用后可以直接调用组件的方法或访问数据。我们下那里看看用<code>ref</code>来访问组件的实例：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// component-a 子组件</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token punctuation">{</span>
			title<span class="token punctuation">:</span><span class="token string">'vue.js'</span>
	<span class="token punctuation">}</span>
   <span class="token punctuation">}</span><span class="token punctuation">,</span>
    methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token function">sayHello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            window<span class="token punctuation">.</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'hello'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><div class="language-vue line-numbers-mode"><pre class="language-vue"><code>// 父组件
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>component-a</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>comA<span class="token punctuation">'</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
	<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
        <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">const</span> comA <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>comA
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>comA<span class="token punctuation">.</span>title<span class="token punctuation">)</span> <span class="token comment">// vue.js</span>
            comA<span class="token punctuation">.</span><span class="token function">sayHellow</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// alert('hello')</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>不过，<strong>这两种方法的弊端是，无法在跨级或兄弟间通信。</strong></p> <div class="language-vue line-numbers-mode"><pre class="language-vue"><code>// parent
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>component-a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>component-a</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>component-b</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>component-b</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>component-c</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>component-c</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>我们想在 component-a 中，访问到引用它的页面中(这里就是 parent.vue)的两个 component-b 组件，那这种情况下，就需要配置额外的插件或工具了，比如 Vuex 和 Bus 的解决方案。</p> <h2 id="总结"><a href="#总结" aria-hidden="true" class="header-anchor">#</a> 总结</h2> <p>常见使用场景可以分为三类：</p> <ul><li>父子通信：父向子传递数据是通过 props ，子向父传递数据是通过 events($emit)；通过父链/子链也可以通信($parent/$children)；ref 也可以访问组件实例；provide/inject API；$attrs/$listeners</li> <li>兄弟通信：Bus、Vuex</li> <li>跨级通信：Bus、Vuex；provide/inject API、$attrs/$listeners</li></ul> <h2 id="原文链接"><a href="#原文链接" aria-hidden="true" class="header-anchor">#</a> 原文链接</h2> <p><a href="https://segmentfault.com/a/1190000019208626" target="_blank" rel="noopener noreferrer">vue组件间通信六种方式（完整版）<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">8/4/2019, 4:37:37 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/web_blog/blog/JavaScript相关/Console不止log.html" class="prev">console 不止 log</a></span> <span class="next"><a href="/web_blog/blog/Vue相关/Vuex用法详解.html">Vuex用法详解</a>→
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/web_blog/assets/js/app.91c2830f.js" defer></script><script src="/web_blog/assets/js/2.eab7b1a3.js" defer></script><script src="/web_blog/assets/js/11.810ef8d7.js" defer></script>
  </body>
</html>
