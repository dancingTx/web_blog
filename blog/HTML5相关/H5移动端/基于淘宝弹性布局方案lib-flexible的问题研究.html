<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>基于淘宝弹性布局方案lib-flexible的问题研究 | 前端菜鸟的进阶之路</title>
    <meta name="description" content="编程不易，砥砺前行">
    <link rel="icon" href="/web_blog/favicon.png">
    
    <link rel="preload" href="/web_blog/assets/css/0.styles.7a36dbfb.css" as="style"><link rel="preload" href="/web_blog/assets/js/app.91c2830f.js" as="script"><link rel="preload" href="/web_blog/assets/js/2.eab7b1a3.js" as="script"><link rel="preload" href="/web_blog/assets/js/8.e30cf33c.js" as="script"><link rel="prefetch" href="/web_blog/assets/js/10.b7c51a89.js"><link rel="prefetch" href="/web_blog/assets/js/11.810ef8d7.js"><link rel="prefetch" href="/web_blog/assets/js/12.84690c1b.js"><link rel="prefetch" href="/web_blog/assets/js/13.014fa390.js"><link rel="prefetch" href="/web_blog/assets/js/14.b6a094b6.js"><link rel="prefetch" href="/web_blog/assets/js/15.73574f0c.js"><link rel="prefetch" href="/web_blog/assets/js/16.6d25e66c.js"><link rel="prefetch" href="/web_blog/assets/js/17.6da21962.js"><link rel="prefetch" href="/web_blog/assets/js/18.e4bbeb45.js"><link rel="prefetch" href="/web_blog/assets/js/19.9d29afb6.js"><link rel="prefetch" href="/web_blog/assets/js/20.6e359f8f.js"><link rel="prefetch" href="/web_blog/assets/js/21.b6a44bf0.js"><link rel="prefetch" href="/web_blog/assets/js/22.72395c6d.js"><link rel="prefetch" href="/web_blog/assets/js/23.3cf07315.js"><link rel="prefetch" href="/web_blog/assets/js/24.ce3af049.js"><link rel="prefetch" href="/web_blog/assets/js/25.be8464ab.js"><link rel="prefetch" href="/web_blog/assets/js/26.818e6723.js"><link rel="prefetch" href="/web_blog/assets/js/27.f604fd0e.js"><link rel="prefetch" href="/web_blog/assets/js/28.ea43a8e0.js"><link rel="prefetch" href="/web_blog/assets/js/29.6cbe154c.js"><link rel="prefetch" href="/web_blog/assets/js/3.79e8f6ea.js"><link rel="prefetch" href="/web_blog/assets/js/30.3cce892a.js"><link rel="prefetch" href="/web_blog/assets/js/31.eb02c772.js"><link rel="prefetch" href="/web_blog/assets/js/32.b6fc1c31.js"><link rel="prefetch" href="/web_blog/assets/js/33.ec19d2a3.js"><link rel="prefetch" href="/web_blog/assets/js/34.e7982556.js"><link rel="prefetch" href="/web_blog/assets/js/35.6a41dc93.js"><link rel="prefetch" href="/web_blog/assets/js/36.de0c92ff.js"><link rel="prefetch" href="/web_blog/assets/js/37.2a90e558.js"><link rel="prefetch" href="/web_blog/assets/js/38.9e70b18a.js"><link rel="prefetch" href="/web_blog/assets/js/39.89f71dfd.js"><link rel="prefetch" href="/web_blog/assets/js/4.25ef38aa.js"><link rel="prefetch" href="/web_blog/assets/js/40.e174e7e4.js"><link rel="prefetch" href="/web_blog/assets/js/41.db4885dc.js"><link rel="prefetch" href="/web_blog/assets/js/42.3319ecbf.js"><link rel="prefetch" href="/web_blog/assets/js/43.cc6ba545.js"><link rel="prefetch" href="/web_blog/assets/js/44.0b03addc.js"><link rel="prefetch" href="/web_blog/assets/js/45.7759f79c.js"><link rel="prefetch" href="/web_blog/assets/js/46.b64c0a3b.js"><link rel="prefetch" href="/web_blog/assets/js/47.ec610bc0.js"><link rel="prefetch" href="/web_blog/assets/js/48.1d911c4b.js"><link rel="prefetch" href="/web_blog/assets/js/49.6e433bb5.js"><link rel="prefetch" href="/web_blog/assets/js/5.746bcae1.js"><link rel="prefetch" href="/web_blog/assets/js/50.cae10208.js"><link rel="prefetch" href="/web_blog/assets/js/51.172c43fc.js"><link rel="prefetch" href="/web_blog/assets/js/52.2d0abb1b.js"><link rel="prefetch" href="/web_blog/assets/js/53.6601a9d1.js"><link rel="prefetch" href="/web_blog/assets/js/54.4db27d09.js"><link rel="prefetch" href="/web_blog/assets/js/55.b676ed30.js"><link rel="prefetch" href="/web_blog/assets/js/56.2f94d7d3.js"><link rel="prefetch" href="/web_blog/assets/js/57.739d9718.js"><link rel="prefetch" href="/web_blog/assets/js/58.14252a7f.js"><link rel="prefetch" href="/web_blog/assets/js/59.9c05cedd.js"><link rel="prefetch" href="/web_blog/assets/js/6.d8f4b14d.js"><link rel="prefetch" href="/web_blog/assets/js/60.10980736.js"><link rel="prefetch" href="/web_blog/assets/js/61.6dbb0bf2.js"><link rel="prefetch" href="/web_blog/assets/js/62.2b9de86f.js"><link rel="prefetch" href="/web_blog/assets/js/63.3c461591.js"><link rel="prefetch" href="/web_blog/assets/js/64.cb9c7ff9.js"><link rel="prefetch" href="/web_blog/assets/js/65.3027aedc.js"><link rel="prefetch" href="/web_blog/assets/js/66.8fa94b0b.js"><link rel="prefetch" href="/web_blog/assets/js/67.1196783a.js"><link rel="prefetch" href="/web_blog/assets/js/68.9e3adf92.js"><link rel="prefetch" href="/web_blog/assets/js/69.30b26df4.js"><link rel="prefetch" href="/web_blog/assets/js/7.bef0e458.js"><link rel="prefetch" href="/web_blog/assets/js/70.ea55f415.js"><link rel="prefetch" href="/web_blog/assets/js/71.99deb135.js"><link rel="prefetch" href="/web_blog/assets/js/72.b411f500.js"><link rel="prefetch" href="/web_blog/assets/js/73.ae212902.js"><link rel="prefetch" href="/web_blog/assets/js/74.c42cb468.js"><link rel="prefetch" href="/web_blog/assets/js/75.4841d167.js"><link rel="prefetch" href="/web_blog/assets/js/76.8152f076.js"><link rel="prefetch" href="/web_blog/assets/js/77.5650be83.js"><link rel="prefetch" href="/web_blog/assets/js/78.13e5f2de.js"><link rel="prefetch" href="/web_blog/assets/js/79.981af0a6.js"><link rel="prefetch" href="/web_blog/assets/js/80.79c69641.js"><link rel="prefetch" href="/web_blog/assets/js/81.acfa7b78.js"><link rel="prefetch" href="/web_blog/assets/js/82.4422108d.js"><link rel="prefetch" href="/web_blog/assets/js/83.65d9e4db.js"><link rel="prefetch" href="/web_blog/assets/js/84.b8c62118.js"><link rel="prefetch" href="/web_blog/assets/js/9.ebc19581.js">
    <link rel="stylesheet" href="/web_blog/assets/css/0.styles.7a36dbfb.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/web_blog/" class="home-link router-link-active"><!----> <span class="site-name">前端菜鸟的进阶之路</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/web_blog/" class="nav-link">首页</a></div><div class="nav-item"><a href="/web_blog/blog/" class="nav-link router-link-active">技术·博文</a></div><div class="nav-item"><a href="/web_blog/question/" class="nav-link">经典·面试</a></div> <a href="https://github.com/dancingTx/web_blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/web_blog/" class="nav-link">首页</a></div><div class="nav-item"><a href="/web_blog/blog/" class="nav-link router-link-active">技术·博文</a></div><div class="nav-item"><a href="/web_blog/question/" class="nav-link">经典·面试</a></div> <a href="https://github.com/dancingTx/web_blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JS知识汇总</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JS框架-Vue篇</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JS框架-React篇</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Node</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>NPM</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端自动化及工具</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>H5移动端</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/web_blog/blog/HTML5相关/H5移动端/基于淘宝弹性布局方案lib-flexible的问题研究.html" class="active sidebar-link">基于淘宝弹性布局方案lib-flexible的问题研究</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web_blog/blog/HTML5相关/H5移动端/基于淘宝弹性布局方案lib-flexible的问题研究.html#_1-lib-flexible不能与响应式布局兼容" class="sidebar-link">1.lib-flexible不能与响应式布局兼容</a></li><li class="sidebar-sub-header"><a href="/web_blog/blog/HTML5相关/H5移动端/基于淘宝弹性布局方案lib-flexible的问题研究.html#_2-1px边框在lib-flexible下如何处理" class="sidebar-link">2.1px边框在lib-flexible下如何处理</a></li><li class="sidebar-sub-header"><a href="/web_blog/blog/HTML5相关/H5移动端/基于淘宝弹性布局方案lib-flexible的问题研究.html#_3-lib-flexible如何处理retina屏下的background-image" class="sidebar-link">3. lib-flexible如何处理retina屏下的background-image</a></li><li class="sidebar-sub-header"><a href="/web_blog/blog/HTML5相关/H5移动端/基于淘宝弹性布局方案lib-flexible的问题研究.html#原文链接" class="sidebar-link">原文链接</a></li></ul></li><li><a href="/web_blog/blog/HTML5相关/H5移动端/使用Flexible实现手淘H5页面的终端适配.html" class="sidebar-link">使用Flexible实现手淘H5页面的终端适配</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>H5中的WebAPI</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>网络协议</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>软技能</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据结构</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/web_blog/blog/声明.html" class="sidebar-link">声明</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="基于淘宝弹性布局方案lib-flexible的问题研究"><a href="#基于淘宝弹性布局方案lib-flexible的问题研究" aria-hidden="true" class="header-anchor">#</a> 基于淘宝弹性布局方案lib-flexible的问题研究</h1> <p><code>lib-flexible</code>从某种意义上解决了移动端多端适配的问题，但同时，这种适配方案也存在着无法改变的缺陷。</p> <p><code>lib-flexible</code>在做适配的时候会修改<code>viewport</code>的<code>initial-scale</code>，导致<code>viewport</code>的<code>width</code>不等于<code>device-width</code>，使得那些根据<code>width</code>编写的<code>media query</code>不一定如预期一般执行，还有移动端Web经典的<code>Retina</code>屏问题和<code>1px</code>边框问题在<code>lib-flexible</code>下也会于通常的做法有所差异，接下来就根据问题提供一些解决办法及思路。</p> <h2 id="_1-lib-flexible不能与响应式布局兼容"><a href="#_1-lib-flexible不能与响应式布局兼容" aria-hidden="true" class="header-anchor">#</a> 1.lib-flexible不能与响应式布局兼容</h2> <p>先说说响应式布局的一些基本认识：</p> <p>响应式布局的表现是：网页通过CSS媒介查询判断可视区域的宽度，在不同的范围应用不同的样式，以便在不同尺寸的设备上呈现最佳的界面效果。经典的例子是，有一个商品列表页，应用响应式布局后，可能在PC端采用4列布局展示，在平板上可能采用3列布局展示，在手机上只需要1列布局展示。这种布局的最大好处在于节省人力、资源和时间，因此很多公司都喜欢采用此种方案。而响应式布局有两个必要条件：</p> <ul><li><p>1.是<code>viewport</code>的设置，<code>width</code>跟<code>initial-scale</code>要采用如下配置，保证<code>viewport</code>的宽度和<code>device-width</code>一致：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>viewport<span class="token punctuation">'</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>width=device-width,initial-scale=1<span class="token punctuation">'</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>2.是要利用<code>media query</code>，针对不同的<code>width</code>范围，编写不同的CSS,比如<code>bootstrap</code>:</p> <div class="language-css line-numbers-mode"><pre class="language-css"><code><span class="token atrule"><span class="token rule">@media</span> <span class="token punctuation">(</span><span class="token property">max-width</span><span class="token punctuation">:</span> <span class="token rule">@screen-xs-max</span><span class="token punctuation">)</span></span> <span class="token punctuation">{</span> ... <span class="token punctuation">}</span>
<span class="token atrule"><span class="token rule">@media</span> <span class="token punctuation">(</span><span class="token property">min-width</span><span class="token punctuation">:</span> <span class="token rule">@screen-sm-min</span><span class="token punctuation">)</span> and <span class="token punctuation">(</span><span class="token property">max-width</span><span class="token punctuation">:</span> <span class="token rule">@screen-sm-max</span><span class="token punctuation">)</span></span> <span class="token punctuation">{</span> ... <span class="token punctuation">}</span>
<span class="token atrule"><span class="token rule">@media</span> <span class="token punctuation">(</span><span class="token property">min-width</span><span class="token punctuation">:</span> <span class="token rule">@screen-md-min</span><span class="token punctuation">)</span> and <span class="token punctuation">(</span><span class="token property">max-width</span><span class="token punctuation">:</span> <span class="token rule">@screen-md-max</span><span class="token punctuation">)</span></span> <span class="token punctuation">{</span> ... <span class="token punctuation">}</span>
<span class="token atrule"><span class="token rule">@media</span> <span class="token punctuation">(</span><span class="token property">min-width</span><span class="token punctuation">:</span> <span class="token rule">@screen-lg-min</span><span class="token punctuation">)</span></span> <span class="token punctuation">{</span> ... <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li></ul> <p>需要注意的是，第1个要求提到的<code>device-width</code>与<code>media query</code>里面的<code>device-width</code>属性表达的意思有些区别：第1个要求提到的<code>device-width</code>在移动设备下指的是设备的宽度，但是在PC下指的是浏览器的可视区域宽度，比如下面的网页，我把浏览器窗口缩小，然后可以看到<code>viewport</code>里尽管已经把<code>width</code>设置成了<code>device-width</code>，但是网页大小却不是我的桌面分辨率宽度(设备宽度)：</p> <p><img src="/web_blog/assets/img/459873-20160109212430184-426453882.de0ec8fc.png" alt=""></p> <p><code>media query</code>里的<code>device-width</code>属性，始终指的是设备的宽度。所以响应式布局的媒介查询要用<code>width</code>属性，不用<code>device-width</code>属性，因为在桌面设备下，把浏览器窗口缩小的时候，<code>device-width</code>并不会发生变化，当调整浏览器窗口大小就看不到响应式的效果。</p> <p>再来看看<code>lib-flexible</code>的特点：</p> <p><code>lib-flexible</code>在适配的时候会修改<code>viewport</code>的<code>initial-scale</code>,导致<code>viewport</code>的<code>width</code>不等于<code>device-width</code>。这是采用<code>lib-flexible</code>，在IPhone6+下适配后，自动添加的<code>viewport</code>设置代码：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>viewport<span class="token punctuation">'</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>initial-scale=0.3333333333333333, maximum-scale=0.3333333333333333, minimum-scale=0.3333333333333333, user-scalable=no<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>在这个<code>viewport</code>的作用下，网页的缩放系数为<code>0.3333333333333333</code>，IPhone6+的<code>device-width</code>为<code>414</code>个不缩放的CSS像素，经过缩放后，<code>viewport</code>的<code>width</code>等于<code>device-width / 0.3333333333333333</code>，为<code>1241</code>个缩放后的CSS像素，远远大于<code>device-width</code>：</p> <p><img src="/web_blog/assets/img/459873-20160109212432325-1240238690.c6300bbb.png" alt=""></p> <p>假如你的网页想同时使用响应式布局和<code>lib-flexible</code>,然后你写了一个媒介查询，需要在<code>1024px</code>以上的分辨率(桌面设备)呈现某个特殊样式：</p> <div class="language-css line-numbers-mode"><pre class="language-css"><code><span class="token atrule"><span class="token rule">@media</span> only screen and <span class="token punctuation">(</span><span class="token property">min-width</span><span class="token punctuation">:</span> 1024px<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
    <span class="token selector">body</span> <span class="token punctuation">{</span>
        <span class="token property">border</span><span class="token punctuation">:</span> 10px solid #ccc<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>会发现这个页面在IPhone6+下也会应用到该媒介查询的样式：</p> <p><img src="/web_blog/assets/img/459873-20160109212433840-1706265521.69f95182.png" alt=""></p> <p>究其原因：IPhone6+下的网页由于<code>lib-flexible</code>的作用，导致页面的<code>width</code>与实际物理分辨率的宽相等，也就是<code>1241</code>个像素，完全达到了该媒介查询的范围。</p> <p>所以，在使用<code>lib-flexible</code>的项目里很难再实现响应式布局，要是有人有这种综合两者一起使用的想法，可得注意了。实际上，这两种方案本质性的东西就不相同，使用场景也不相同。响应式布局的目的是一套代码，能够在手机平板和PC上都有良好的表现，适用于网站类项目，而<code>lib-flexible</code>解决的是手机端网页适配的问题，压根不会去关心平板和PC的表现，适用于<code>web app</code>类项目。</p> <h2 id="_2-1px边框在lib-flexible下如何处理"><a href="#_2-1px边框在lib-flexible下如何处理" aria-hidden="true" class="header-anchor">#</a> 2.1px边框在<code>lib-flexible</code>下如何处理</h2> <p><code>web app</code>有时候会设计出一些特别细的线条或者边框，如果我们直接通过CSS设置边框为<code>1px</code>:</p> <div class="language-css line-numbers-mode"><pre class="language-css"><code><span class="token property">border</span><span class="token punctuation">:</span>1px solid #ccc<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>结果会发现这种边框在手机中看起来的效果，会显得特别粗，之所以会出现这种结果，原因也很简单，因为目前市场大部分手机的分辨率较高，一个CSS像素，比如，上述代码为<code>1px</code>，可能相当于<code>2</code>个甚至是<code>3</code>个物理分辨率像素，而不像PC端，一个CSS像素，始终等于 <code>1</code>个物理分辨率像素，所以手机里看到的<code>1px</code>会比实际的粗。</p> <p>为了解决这个问题，你可能会想到用<code>0.5px</code>来代替<code>1px</code>，不过这个解决不了问题，而且带小数的像素在不同的浏览器下表现不尽相同，要尽量避免。</p> <p>那么通常来说在<code>web app</code>下显示<code>1px</code>的做法是怎么样的呢？在<code>weui</code>源码中有一个较好的办法，值得分享：</p> <div class="language-css line-numbers-mode"><pre class="language-css"><code>//这是一个mixin，用来设置顶部的边框，其它方向的代码没有贴出
.<span class="token function">setTopLine</span><span class="token punctuation">(</span><span class="token atrule"><span class="token rule">@c</span><span class="token punctuation">:</span> #C7C7C7<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
    <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">;</span>
    <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
    <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 1px<span class="token punctuation">;</span>
    <span class="token property">border-top</span><span class="token punctuation">:</span> 1px solid <span class="token atrule"><span class="token rule">@c</span><span class="token punctuation">;</span></span>
    <span class="token property">transform-origin</span><span class="token punctuation">:</span> 0 0<span class="token punctuation">;</span>
    <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">scaleY</span><span class="token punctuation">(</span>0.5<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">//应用举例
.weui_cell</span> <span class="token punctuation">{</span>
    // onepx
    <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token selector">;
    &amp;:before</span> <span class="token punctuation">{</span>
        .<span class="token function">setTopLine</span><span class="token punctuation">(</span><span class="token atrule"><span class="token rule">@weuiCellBorderColor</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>这个办法并不是利用<code>border</code>属性来显示边框，而是利用了伪类和<code>transform</code>，最妙的是这个<code>transform</code>，<code>0.5px</code>办不到的事情，它却可以办到。</p> <p>由于<code>lib-flexible</code>在适配的时候，会缩放网页，导致CSS代码中的<code>1px</code>等于物理分辨率的<code>1px</code>，这样子这个<code>1px</code>边框的问题在经过<code>lib-flexible</code>适配的设备下就很好解决了，直接应用<code>border:1px solid xxx</code>即可。但是<strong>lib-flexible目前只适配了iPhone设备，安卓设备压根没做适配</strong>。</p> <p><img src="/web_blog/assets/img/459873-20160109212435231-1310836847.62f0b085.png" alt=""></p> <p>通过源码可以看出，Android设备的<code>dpr</code>全部设置为<code>1</code>，因此也导致了在Android设备下，<code>1px</code>的边框问题依然存在。所以为了<code>lib-flexible</code>的项目里解决掉<code>1px</code>问题，就需要综合上述两种做法：</p> <div class="language-css line-numbers-mode"><pre class="language-css"><code>.<span class="token function">setTopLine</span><span class="token punctuation">(</span><span class="token atrule"><span class="token rule">@c</span><span class="token punctuation">:</span> #C7C7C7<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
  <span class="token selector">&amp;</span> <span class="token punctuation">{</span>
    <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token selector">&amp;:before</span> <span class="token punctuation">{</span>
    <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">;</span>
    <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
    <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 1px<span class="token punctuation">;</span>
    <span class="token property">border-top</span><span class="token punctuation">:</span> 1px solid <span class="token atrule"><span class="token rule">@c</span><span class="token punctuation">;</span></span>
  <span class="token punctuation">}</span>

  <span class="token selector">[data-dpr=&quot;1&quot;] &amp;:before</span> <span class="token punctuation">{</span>
    <span class="token property">transform-origin</span><span class="token punctuation">:</span> 0 0<span class="token punctuation">;</span>
    <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">scaleY</span><span class="token punctuation">(</span>0.5<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">/*照着这个可以再写setBottomLine等相关mixin*/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>通过两种方案的混合，经过测试，在<code>devicePixelRatio</code>为<code>3</code>的<code>meilan note</code>上，显示出的线条非常细腻，看起来比较舒服，IPhone上的表现也很不错，以下是<code>meilan note</code>测试截图：</p> <p><img src="data:image/jpeg;base64,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" alt=""></p> <p>第一根线是上面的<code>mixin</code>效果；第二根线是直接使用<code>border:1px solid xxx;</code>的效果。</p> <p>以上提到的<code>1px</code>边框的做法有三个缺陷，在使用时需要注意：</p> <ul><li>他会占用掉<code>before</code>伪类</li> <li>没办法做圆角</li> <li>很难实现多条边框，除非嵌套，或者再利用上<code>after</code>伪类</li></ul> <p>尽管如此，以上做法还算是比较有用的做法，因为这种细线边框属于比较特殊的设计要求，并不是每处边框都需要做成这样，在开发<code>web app</code>的时候用这个方法保证特殊线条的设计要求，其它的边线，我觉得直接用<code>border</code>并没有关系，你可以直接用你的手机打开<code>bootstrap</code>的官方页面，看它里面的按钮边框，效果都还不错。</p> <h2 id="_3-lib-flexible如何处理retina屏下的background-image"><a href="#_3-lib-flexible如何处理retina屏下的background-image" aria-hidden="true" class="header-anchor">#</a> 3. lib-flexible如何处理retina屏下的background-image</h2> <p>几年之前，<code>Retina</code>屏，也就是所谓的高清屏，还不像现在这么普遍，12年我买的第一个安卓机是华为u8825d，分辨率只有<code>480*800</code>，而且当时市面上大部分安卓机基本上都是这个分辨率，像IPhone4那种<code>640*960</code>级别的机子很少，为了解决普通背景图片在IPhone4下显示模糊的问题，基本都是采用这种做法：</p> <div class="language-css line-numbers-mode"><pre class="language-css"><code><span class="token selector">.css</span><span class="token punctuation">{</span><span class="token comment">/* 普通显示屏(设备像素比例小于等于1.3)使用1倍的图 */</span> 
    <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span>img_1x.png<span class="token punctuation">)</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token atrule"><span class="token rule">@media</span> only screen and <span class="token punctuation">(</span><span class="token property">-webkit-min-device-pixel-ratio</span><span class="token punctuation">:</span>1.5<span class="token punctuation">)</span></span><span class="token punctuation">{</span>
<span class="token selector">.css</span><span class="token punctuation">{</span><span class="token comment">/* 高清显示屏(设备像素比例大于等于1.5)使用2倍图  */</span>
    <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span>img_2x.png<span class="token punctuation">)</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>估计当时应该是<code>320</code>的设计稿，<code>img_1x.png</code>是在<code>320</code>设计稿下切出的图，然后<code>img_2x.png</code>是在<code>320</code>设计稿矢量放大<code>2</code>倍后切出的图，高清屏显示<code>img_2x.png</code>，这样就能解决当时IPhone4背景图片模糊的问题。</p> <p>时至今日，手机都是走高配置，低价格的发展路线，<code>480*800</code>这种级别的机子，市面上越来越少，大部分手机的分辨率级别都达到了IPhone4的标准，比iphone4的清晰级别更高的手机也越来越多，一个800块的魅蓝note，它的<code>devicePixelRatio</code>都已经达到了3，原先解决<code>background-image</code>问题的方法，需要调整一下才能适用于现在：</p> <div class="language-css line-numbers-mode"><pre class="language-css"><code><span class="token selector">.css</span><span class="token punctuation">{</span><span class="token comment">/* 普通显示屏(设备像素比例小于等于2)使用2倍的图 */</span> 
    <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span>img_2x.png<span class="token punctuation">)</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token atrule"><span class="token rule">@media</span> only screen and <span class="token punctuation">(</span><span class="token property">-webkit-min-device-pixel-ratio</span><span class="token punctuation">:</span>2.1<span class="token punctuation">)</span></span><span class="token punctuation">{</span>
<span class="token selector">.css</span><span class="token punctuation">{</span><span class="token comment">/* 高清显示屏(设备像素比例大于等于2.1)使用3倍图  */</span>
    <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span>img_3x.png<span class="token punctuation">)</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>代码中的<code>2x</code>和<code>3x</code>是相当于<code>320</code>的设计稿而言的，<code>2x</code>代替了原先的<code>1x</code>，<code>3x</code>代替了原先的<code>2x</code>。现在的设计稿也不再是<code>320</code>，而是<code>640</code>，<code>2x</code>就是在<code>640</code>下切出的图，<code>3x</code>是在<code>640</code>基础上矢量放大<code>1.5</code>切出的图。在这个代码的作用下，分辨率在<code>640</code>以下的设备都会显示<code>2x</code>的图，由于<code>2x</code>的图本身是在<code>640</code>的设计稿切出的，所以这些设备下不会有模糊的现象，在<code>640</code>以上的分辨率，会显示<code>3x</code>的图，由于<code>3x</code>的图是在<code>960</code>的分辨率下切出的，所以这种图在分辨率小于<code>960</code>的设备下都不会模糊。以前<code>1x</code>的情况根本不用再考虑了，以后不会再有需要<code>1x</code>图的设备，说不定过几年，市面上的手机全是<code>devicePixelRatio</code>在<code>2.5</code>以上的标准时，连<code>2x</code>的情况也不用考虑了。</p> <p><code>lib-flexible</code>在IPhone6推出之后，把设计稿的尺寸提高到了<code>750</code>，切图时还是按<code>2x</code>和<code>3x</code>的方法来切，这样的话，经过<code>lib-flexible</code>适配的设备，分辨率在<code>750</code>以下都会显示<code>2x</code>的图，肯定不会模糊；分辨率在<code>750</code>以上的设备，会显示<code>3x</code>的图，也不会出现模糊。不过由于<code>lib-flexible</code>只适配了IPhone的问题，所以我上篇博客中提到的用<code>data-dpr</code>来显示不同的图片的做法是错误的，因为有些安卓机，比如我的魅族note，<code>devicePixelRatio</code>是<code>3</code>，打开<code>app</code>页面，看到的图片却仍然还是<code>2x</code>的，显然达不到适配的要求，所以不能用<code>data-dpr</code>去适配，而应该采用下面这个做法：</p> <div class="language-css line-numbers-mode"><pre class="language-css"><code>.<span class="token function">retina-image</span><span class="token punctuation">(</span><span class="token atrule"><span class="token rule">@background-image</span><span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
  <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token function">url</span><span class="token punctuation">(</span><span class="token string">&quot;../img/@2x/@{background-image}?v=@@version&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">background-size</span><span class="token punctuation">:</span> 100% 100%<span class="token punctuation">;</span>
  <span class="token property">background-position</span><span class="token punctuation">:</span>left top<span class="token punctuation">;</span>

  @media only screen and <span class="token punctuation">(</span><span class="token property">-webkit-min-device-pixel-ratio</span><span class="token punctuation">:</span> 2.5<span class="token punctuation">)</span><span class="token punctuation">,</span>
  only screen and <span class="token punctuation">(</span><span class="token property">min--moz-device-pixel-ratio</span><span class="token punctuation">:</span> 2.5<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">/* 注意这里的写法比较特殊 */</span>
  <span class="token selector">only screen and (-o-min-device-pixel-ratio: 5/2),
  only screen and (min-device-pixel-ratio: 2.5),
  only screen and (min-resolution: 240dpi),
  only screen and (min-resolution: 2.5dppx)</span> <span class="token punctuation">{</span>
    <span class="token selector">&amp;</span> <span class="token punctuation">{</span>
      <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token function">url</span><span class="token punctuation">(</span><span class="token string">&quot;../img/@3x/@{background-image}?v=@@version&quot;</span><span class="token punctuation">)</span> <span class="token important">!important</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  //1dppx = 1devicePixelRatio<span class="token punctuation">,</span> 1dppx = 96dpi.
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>这个代码的最终效果是：</p> <ul><li><p><code>devicePixelRatio</code>大于等于2.5的设备都会应用到<code>3x</code>图</p></li> <li><p>其它设备都会应用到<code>2x</code>的图。</p></li></ul> <p>这个方法，在<code>chrome</code>的模拟器里测试过很多机型，效果不错，<strong>不过它只适用于不使用雪碧图的背景图片</strong>，如果要在<code>lib-flexible</code>的项目里使用雪碧图作背景图片，同时又要考虑<code>retina</code>屏的话，需要将上面这个方法稍微改动一下。</p> <p>首先看下不使用<code>lib-flexible</code>时，雪碧图背景在<code>retina</code>下是怎么做的，以腾讯的一个活动页面来说明<a href="http://qzs.qq.com/qzone/qzact/act/qzapp/qzone5.0/mobile/index.html" target="_blank" rel="noopener noreferrer">点击这里<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，这是它在使用<code>1x</code>的雪碧图时某个元素的<code>background</code>的样式：</p> <p><img src="/web_blog/assets/img/459873-20160109212437465-2044438147.91806755.png" alt=""></p> <p>这是它在使用<code>2x</code>的雪碧图时某个元素的<code>background</code>的样式：</p> <p><img src="/web_blog/assets/img/459873-20160109212439371-1665206951.7a344a84.png" alt=""></p> <p>总结下它这个做法：</p> <ul><li><p>先把设计稿切出的图，合并成一张雪碧图，腾讯这个例子的设计稿是<code>320</code>的，所以它的切图都是<code>1x</code>的，这张雪碧图也就是<code>1x</code>的，大小为<code>643 * 152</code></p></li> <li><p>设计稿放大<code>2</code>倍，切图合并成一张<code>2x</code>的雪碧图，大小为<code>1286 * 304</code></p></li> <li><p>普清屏下只应用<code>background-image</code>和<code>background-position属性，设置</code>1x`雪碧图作为背景，代码参考截图</p></li> <li><p>高清屏下除了应用background-image和background-position属性，还要应用background-size属性，并且这个<code>background-size</code>的大小要设置为<code>1x</code>雪碧图的大小，<code>background-position</code>的值要与（3）里配置的值相同，代码参考截图。</p></li></ul> <p>如果把它做成一个<code>mixin</code>的话应该是类似这样的：</p> <div class="language-css line-numbers-mode"><pre class="language-css"><code>.<span class="token function">retina-image</span><span class="token punctuation">(</span><span class="token atrule"><span class="token rule">@background-image</span><span class="token punctuation">,</span><span class="token rule">@background-pos-x</span><span class="token punctuation">,</span><span class="token rule">@background-pos-y</span><span class="token punctuation">,</span><span class="token rule">@background-size-x</span><span class="token punctuation">,</span><span class="token rule">@background-size-y</span><span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
  <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token function">url</span><span class="token punctuation">(</span><span class="token string">&quot;../img/@1x/@{background-image}?v=@@version&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">background-position</span><span class="token punctuation">:</span><span class="token atrule"><span class="token rule">@background-pos-x</span> <span class="token rule">@background-pos-y</span><span class="token punctuation">;</span></span>

  <span class="token atrule"><span class="token rule">@media</span> only screen and <span class="token punctuation">(</span><span class="token property">-webkit-min-device-pixel-ratio</span><span class="token punctuation">:</span> 1.25<span class="token punctuation">)</span><span class="token punctuation">,</span>
  only screen and <span class="token punctuation">(</span><span class="token property">min-resolution</span><span class="token punctuation">:</span> 120dpi<span class="token punctuation">)</span><span class="token punctuation">,</span>
  only screen and <span class="token punctuation">(</span><span class="token property">min-resolution</span><span class="token punctuation">:</span> 1.25dppx<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
    <span class="token selector">&amp;</span> <span class="token punctuation">{</span>
      <span class="token property">background-size</span><span class="token punctuation">:</span> <span class="token atrule"><span class="token rule">@background-size-x</span> <span class="token rule">@background-size-y</span><span class="token punctuation">;</span></span>
      <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token function">url</span><span class="token punctuation">(</span><span class="token string">&quot;../img/@2x/@{background-image}?v=@@version&quot;</span><span class="token punctuation">)</span> <span class="token important">!important</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  //1dppx = 1devicePixelRatio<span class="token punctuation">,</span> 1dppx = 96dpi.
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>考虑到<code>1x</code>不会再有的情况，上面这个<code>mixin</code>可以再调整一下：</p> <div class="language-css line-numbers-mode"><pre class="language-css"><code>.<span class="token function">retina-image</span><span class="token punctuation">(</span><span class="token atrule"><span class="token rule">@background-image</span><span class="token punctuation">,</span><span class="token rule">@background-size-x</span><span class="token punctuation">,</span><span class="token rule">@background-size-y</span><span class="token punctuation">,</span><span class="token rule">@background-pos-x</span><span class="token punctuation">,</span><span class="token rule">@background-pos-y</span><span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
  <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token function">url</span><span class="token punctuation">(</span><span class="token string">&quot;../img/@2x/@{background-image}?v=@@version&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">background-size</span><span class="token punctuation">:</span> <span class="token atrule"><span class="token rule">@background-size-x</span> <span class="token rule">@background-size-y</span><span class="token punctuation">;</span></span>
  <span class="token property">background-position</span><span class="token punctuation">:</span><span class="token atrule"><span class="token rule">@background-pos-x</span> <span class="token rule">@background-pos-y</span><span class="token punctuation">;</span></span>

  @media only screen and <span class="token punctuation">(</span><span class="token property">-webkit-min-device-pixel-ratio</span><span class="token punctuation">:</span> 2.5<span class="token punctuation">)</span><span class="token punctuation">,</span>
  only screen and <span class="token punctuation">(</span><span class="token property">min--moz-device-pixel-ratio</span><span class="token punctuation">:</span> 2.5<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">/* 注意这里的写法比较特殊 */</span>
  <span class="token selector">only screen and (-o-min-device-pixel-ratio: 5/2),
  only screen and (min-device-pixel-ratio: 2.5),
  only screen and (min-resolution: 240dpi),
  only screen and (min-resolution: 2.5dppx)</span> <span class="token punctuation">{</span>
    <span class="token selector">&amp;</span> <span class="token punctuation">{</span>
      <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token function">url</span><span class="token punctuation">(</span><span class="token string">&quot;../img/@3x/@{background-image}?v=@@version&quot;</span><span class="token punctuation">)</span> <span class="token important">!important</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  //1dppx = 1devicePixelRatio<span class="token punctuation">,</span> 1dppx = 96dpi.
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>默认用<code>2x</code>的图，<code>devicePixelRatio</code>大于等于<code>2.5</code>的设备用<code>3x</code>的图。这个调整后的<code>mixin</code>就是<code>lib-flexible</code>下，使用雪碧图背景的方法，应用举例：</p> <div class="language-css line-numbers-mode"><pre class="language-css"><code><span class="token atrule"><span class="token rule">@font-size-base</span><span class="token punctuation">:</span> 75<span class="token punctuation">;</span></span>
<span class="token selector">.btn-android</span> <span class="token punctuation">{</span>
  .<span class="token function">retina-image</span><span class="token punctuation">(</span><span class="token string">&quot;sprite.png&quot;</span><span class="token punctuation">,</span> 414rem/<span class="token atrule"><span class="token rule">@font-size-base</span><span class="token punctuation">,</span> 232rem/<span class="token rule">@font-size-base</span><span class="token punctuation">,</span> 0<span class="token punctuation">,</span> -64rem/<span class="token rule">@font-size-base</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><code>sprite.png</code>用<code>750</code>设计稿的切图合并后的大小是<code>414 * 232</code>，<code>.btn-android</code>这个按钮的<code>position</code>为<code>0 –64px</code>。</p> <p>尽管这个方法看起来完美，但是不建议使用，因为它的适配效果不好，这是IPhone6下的效果：</p> <p><img src="data:image/png;base64,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" alt=""></p> <p>看起来不错，那是当然的，因为这就是它默认没有任何缩放的效果。然后看IPhone6+的效果:</p> <p><img src="/web_blog/assets/img/459873-20160109212441762-1534848391.f754f5d7.png" alt=""></p> <p>有点差异，但好像还能接受。再看看nexus6的效果：</p> <p><img src="/web_blog/assets/img/459873-20160109212442606-1315306942.264d64e3.png" alt=""></p> <p>这就不能忍了，样式差的离谱。造成这个差异的原因也很简单，就是<code>rem</code>的副作用，腾讯的页面里所有<code>position,size</code>都是不带小数的数值，而且<code>2x</code>跟<code>1x</code>之间是整数的翻倍，而不是<code>3x</code>跟<code>2x</code>之间的<code>1.5</code>倍，<code>lib-flexible</code>会导致大部分的设备下<code>position</code>和<code>size</code>都是小数数值，所以很难保证背景图片缩放后还能通过<code>position</code>显示到正确的位置：</p> <p><img src="/web_blog/assets/img/459873-20160109212443496-375628135.2ffa1008.png" alt=""></p> <p>从网页优化的角度来说，减少请求数，减少请求数据大小是两个基本的思路，雪碧图就是一个减少请求数但是不能减少请求数据量的方法。<code>lib-flexible</code>不能使用兼容<code>3x</code>屏的雪碧图的情况看起来是它一个大的缺陷，但实际上也并非如此：雪碧图如果用不了，就采用别的思路来优化，我能想到的更好的就是图片的延迟加载和懒加载，在<code>app</code>页面里控制好默认只加载首屏的图片，并且采用延迟和懒加载的方式，避免阻塞页面的加载，也能有极好的用户体验，打开手机淘宝的页面给人的感觉就是如此，而且你去看看手机淘宝的应用会发现它根本就没有用雪碧图，但是速度还是很快。</p> <h2 id="原文链接"><a href="#原文链接" aria-hidden="true" class="header-anchor">#</a> 原文链接</h2> <p><a href="https://www.cnblogs.com/lyzg/p/5117324.html" target="_blank" rel="noopener noreferrer">基于淘宝弹性布局方案lib-flexible的问题研究<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">8/3/2019, 6:52:07 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/web_blog/blog/前端自动化及工具/使用GraphQL的五大理由.html" class="prev">使用 GraphQL 的五大理由</a></span> <span class="next"><a href="/web_blog/blog/HTML5相关/H5移动端/使用Flexible实现手淘H5页面的终端适配.html">使用Flexible实现手淘H5页面的终端适配</a>→
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/web_blog/assets/js/app.91c2830f.js" defer></script><script src="/web_blog/assets/js/2.eab7b1a3.js" defer></script><script src="/web_blog/assets/js/8.e30cf33c.js" defer></script>
  </body>
</html>
