<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ä¸ºä»€ä¹ˆä¼šå‡ºç°React Hooks? | å‰ç«¯èœé¸Ÿçš„è¿›é˜¶ä¹‹è·¯</title>
    <meta name="description" content="ç¼–ç¨‹ä¸æ˜“ï¼Œç ¥ç ºå‰è¡Œ">
    <link rel="icon" href="/web_blog/favicon.png">
    
    <link rel="preload" href="/web_blog/assets/css/0.styles.7a36dbfb.css" as="style"><link rel="preload" href="/web_blog/assets/js/app.91c2830f.js" as="script"><link rel="preload" href="/web_blog/assets/js/2.eab7b1a3.js" as="script"><link rel="preload" href="/web_blog/assets/js/26.818e6723.js" as="script"><link rel="prefetch" href="/web_blog/assets/js/10.b7c51a89.js"><link rel="prefetch" href="/web_blog/assets/js/11.810ef8d7.js"><link rel="prefetch" href="/web_blog/assets/js/12.84690c1b.js"><link rel="prefetch" href="/web_blog/assets/js/13.014fa390.js"><link rel="prefetch" href="/web_blog/assets/js/14.b6a094b6.js"><link rel="prefetch" href="/web_blog/assets/js/15.73574f0c.js"><link rel="prefetch" href="/web_blog/assets/js/16.6d25e66c.js"><link rel="prefetch" href="/web_blog/assets/js/17.6da21962.js"><link rel="prefetch" href="/web_blog/assets/js/18.e4bbeb45.js"><link rel="prefetch" href="/web_blog/assets/js/19.9d29afb6.js"><link rel="prefetch" href="/web_blog/assets/js/20.6e359f8f.js"><link rel="prefetch" href="/web_blog/assets/js/21.b6a44bf0.js"><link rel="prefetch" href="/web_blog/assets/js/22.72395c6d.js"><link rel="prefetch" href="/web_blog/assets/js/23.3cf07315.js"><link rel="prefetch" href="/web_blog/assets/js/24.ce3af049.js"><link rel="prefetch" href="/web_blog/assets/js/25.be8464ab.js"><link rel="prefetch" href="/web_blog/assets/js/27.f604fd0e.js"><link rel="prefetch" href="/web_blog/assets/js/28.ea43a8e0.js"><link rel="prefetch" href="/web_blog/assets/js/29.6cbe154c.js"><link rel="prefetch" href="/web_blog/assets/js/3.79e8f6ea.js"><link rel="prefetch" href="/web_blog/assets/js/30.3cce892a.js"><link rel="prefetch" href="/web_blog/assets/js/31.eb02c772.js"><link rel="prefetch" href="/web_blog/assets/js/32.b6fc1c31.js"><link rel="prefetch" href="/web_blog/assets/js/33.ec19d2a3.js"><link rel="prefetch" href="/web_blog/assets/js/34.e7982556.js"><link rel="prefetch" href="/web_blog/assets/js/35.6a41dc93.js"><link rel="prefetch" href="/web_blog/assets/js/36.de0c92ff.js"><link rel="prefetch" href="/web_blog/assets/js/37.2a90e558.js"><link rel="prefetch" href="/web_blog/assets/js/38.9e70b18a.js"><link rel="prefetch" href="/web_blog/assets/js/39.89f71dfd.js"><link rel="prefetch" href="/web_blog/assets/js/4.25ef38aa.js"><link rel="prefetch" href="/web_blog/assets/js/40.e174e7e4.js"><link rel="prefetch" href="/web_blog/assets/js/41.db4885dc.js"><link rel="prefetch" href="/web_blog/assets/js/42.3319ecbf.js"><link rel="prefetch" href="/web_blog/assets/js/43.cc6ba545.js"><link rel="prefetch" href="/web_blog/assets/js/44.0b03addc.js"><link rel="prefetch" href="/web_blog/assets/js/45.7759f79c.js"><link rel="prefetch" href="/web_blog/assets/js/46.b64c0a3b.js"><link rel="prefetch" href="/web_blog/assets/js/47.ec610bc0.js"><link rel="prefetch" href="/web_blog/assets/js/48.1d911c4b.js"><link rel="prefetch" href="/web_blog/assets/js/49.6e433bb5.js"><link rel="prefetch" href="/web_blog/assets/js/5.746bcae1.js"><link rel="prefetch" href="/web_blog/assets/js/50.cae10208.js"><link rel="prefetch" href="/web_blog/assets/js/51.172c43fc.js"><link rel="prefetch" href="/web_blog/assets/js/52.2d0abb1b.js"><link rel="prefetch" href="/web_blog/assets/js/53.6601a9d1.js"><link rel="prefetch" href="/web_blog/assets/js/54.4db27d09.js"><link rel="prefetch" href="/web_blog/assets/js/55.b676ed30.js"><link rel="prefetch" href="/web_blog/assets/js/56.2f94d7d3.js"><link rel="prefetch" href="/web_blog/assets/js/57.739d9718.js"><link rel="prefetch" href="/web_blog/assets/js/58.14252a7f.js"><link rel="prefetch" href="/web_blog/assets/js/59.9c05cedd.js"><link rel="prefetch" href="/web_blog/assets/js/6.d8f4b14d.js"><link rel="prefetch" href="/web_blog/assets/js/60.10980736.js"><link rel="prefetch" href="/web_blog/assets/js/61.6dbb0bf2.js"><link rel="prefetch" href="/web_blog/assets/js/62.2b9de86f.js"><link rel="prefetch" href="/web_blog/assets/js/63.3c461591.js"><link rel="prefetch" href="/web_blog/assets/js/64.cb9c7ff9.js"><link rel="prefetch" href="/web_blog/assets/js/65.3027aedc.js"><link rel="prefetch" href="/web_blog/assets/js/66.8fa94b0b.js"><link rel="prefetch" href="/web_blog/assets/js/67.1196783a.js"><link rel="prefetch" href="/web_blog/assets/js/68.9e3adf92.js"><link rel="prefetch" href="/web_blog/assets/js/69.30b26df4.js"><link rel="prefetch" href="/web_blog/assets/js/7.bef0e458.js"><link rel="prefetch" href="/web_blog/assets/js/70.ea55f415.js"><link rel="prefetch" href="/web_blog/assets/js/71.99deb135.js"><link rel="prefetch" href="/web_blog/assets/js/72.b411f500.js"><link rel="prefetch" href="/web_blog/assets/js/73.ae212902.js"><link rel="prefetch" href="/web_blog/assets/js/74.c42cb468.js"><link rel="prefetch" href="/web_blog/assets/js/75.4841d167.js"><link rel="prefetch" href="/web_blog/assets/js/76.8152f076.js"><link rel="prefetch" href="/web_blog/assets/js/77.5650be83.js"><link rel="prefetch" href="/web_blog/assets/js/78.13e5f2de.js"><link rel="prefetch" href="/web_blog/assets/js/79.981af0a6.js"><link rel="prefetch" href="/web_blog/assets/js/8.e30cf33c.js"><link rel="prefetch" href="/web_blog/assets/js/80.79c69641.js"><link rel="prefetch" href="/web_blog/assets/js/81.acfa7b78.js"><link rel="prefetch" href="/web_blog/assets/js/82.4422108d.js"><link rel="prefetch" href="/web_blog/assets/js/83.65d9e4db.js"><link rel="prefetch" href="/web_blog/assets/js/84.b8c62118.js"><link rel="prefetch" href="/web_blog/assets/js/9.ebc19581.js">
    <link rel="stylesheet" href="/web_blog/assets/css/0.styles.7a36dbfb.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/web_blog/" class="home-link router-link-active"><!----> <span class="site-name">å‰ç«¯èœé¸Ÿçš„è¿›é˜¶ä¹‹è·¯</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/web_blog/" class="nav-link">é¦–é¡µ</a></div><div class="nav-item"><a href="/web_blog/blog/" class="nav-link router-link-active">æŠ€æœ¯Â·åšæ–‡</a></div><div class="nav-item"><a href="/web_blog/question/" class="nav-link">ç»å…¸Â·é¢è¯•</a></div> <a href="https://github.com/dancingTx/web_blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/web_blog/" class="nav-link">é¦–é¡µ</a></div><div class="nav-item"><a href="/web_blog/blog/" class="nav-link router-link-active">æŠ€æœ¯Â·åšæ–‡</a></div><div class="nav-item"><a href="/web_blog/question/" class="nav-link">ç»å…¸Â·é¢è¯•</a></div> <a href="https://github.com/dancingTx/web_blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JSçŸ¥è¯†æ±‡æ€»</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JSæ¡†æ¶-Vueç¯‡</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>JSæ¡†æ¶-Reactç¯‡</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/web_blog/blog/Reactç›¸å…³/ä¸ºä»€ä¹ˆä¼šå‡ºç°React_Hooksï¼Ÿ.html" class="active sidebar-link">ä¸ºä»€ä¹ˆä¼šå‡ºç°React Hooks?</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web_blog/blog/Reactç›¸å…³/ä¸ºä»€ä¹ˆä¼šå‡ºç°React_Hooksï¼Ÿ.html#createclass" class="sidebar-link">createClass</a></li><li class="sidebar-sub-header"><a href="/web_blog/blog/Reactç›¸å…³/ä¸ºä»€ä¹ˆä¼šå‡ºç°React_Hooksï¼Ÿ.html#react-component" class="sidebar-link">React.Component</a></li><li class="sidebar-sub-header"><a href="/web_blog/blog/Reactç›¸å…³/ä¸ºä»€ä¹ˆä¼šå‡ºç°React_Hooksï¼Ÿ.html#æ„é€ å‡½æ•°" class="sidebar-link">æ„é€ å‡½æ•°</a></li><li class="sidebar-sub-header"><a href="/web_blog/blog/Reactç›¸å…³/ä¸ºä»€ä¹ˆä¼šå‡ºç°React_Hooksï¼Ÿ.html#è‡ªåŠ¨ç»‘å®š" class="sidebar-link">è‡ªåŠ¨ç»‘å®š</a></li><li class="sidebar-sub-header"><a href="/web_blog/blog/Reactç›¸å…³/ä¸ºä»€ä¹ˆä¼šå‡ºç°React_Hooksï¼Ÿ.html#ç±»å­—æ®µ" class="sidebar-link">ç±»å­—æ®µ</a></li><li class="sidebar-sub-header"><a href="/web_blog/blog/Reactç›¸å…³/ä¸ºä»€ä¹ˆä¼šå‡ºç°React_Hooksï¼Ÿ.html#é‡å¤é€»è¾‘" class="sidebar-link">é‡å¤é€»è¾‘</a></li><li class="sidebar-sub-header"><a href="/web_blog/blog/Reactç›¸å…³/ä¸ºä»€ä¹ˆä¼šå‡ºç°React_Hooksï¼Ÿ.html#å…±äº«éå¯è§†é€»è¾‘" class="sidebar-link">å…±äº«éå¯è§†é€»è¾‘</a></li><li class="sidebar-sub-header"><a href="/web_blog/blog/Reactç›¸å…³/ä¸ºä»€ä¹ˆä¼šå‡ºç°React_Hooksï¼Ÿ.html#ç°çŠ¶" class="sidebar-link">ç°çŠ¶</a></li><li class="sidebar-sub-header"><a href="/web_blog/blog/Reactç›¸å…³/ä¸ºä»€ä¹ˆä¼šå‡ºç°React_Hooksï¼Ÿ.html#react-hooks" class="sidebar-link">React Hooks</a></li><li class="sidebar-sub-header"><a href="/web_blog/blog/Reactç›¸å…³/ä¸ºä»€ä¹ˆä¼šå‡ºç°React_Hooksï¼Ÿ.html#æ€»ç»“" class="sidebar-link">æ€»ç»“</a></li><li class="sidebar-sub-header"><a href="/web_blog/blog/Reactç›¸å…³/ä¸ºä»€ä¹ˆä¼šå‡ºç°React_Hooksï¼Ÿ.html#åŸæ–‡é“¾æ¥" class="sidebar-link">åŸæ–‡é“¾æ¥</a></li></ul></li><li><a href="/web_blog/blog/Reactç›¸å…³/Reactä¸­çš„ç”Ÿå‘½å‘¨æœŸ.html" class="sidebar-link">React ä¸­çš„ç”Ÿå‘½å‘¨æœŸ</a></li><li><a href="/web_blog/blog/Reactç›¸å…³/æ–°æ‰‹å…¥å‘è¿·ç‚¹è§£ç–‘.html" class="sidebar-link">æ–°æ‰‹å­¦ä¹  React æ˜“è¿·æƒ‘çš„ç‚¹</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Node</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>NPM</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>å‰ç«¯è‡ªåŠ¨åŒ–åŠå·¥å…·</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>H5ç§»åŠ¨ç«¯</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>H5ä¸­çš„WebAPI</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ç½‘ç»œåè®®</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>è½¯æŠ€èƒ½</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>æ•°æ®ç»“æ„</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/web_blog/blog/å£°æ˜.html" class="sidebar-link">å£°æ˜</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="ä¸ºä»€ä¹ˆä¼šå‡ºç°react-hooks"><a href="#ä¸ºä»€ä¹ˆä¼šå‡ºç°react-hooks" aria-hidden="true" class="header-anchor">#</a> ä¸ºä»€ä¹ˆä¼šå‡ºç°React Hooks?</h1> <p><img src="/web_blog/assets/img/why-react-hooks.c3fcc8dc.jpg" alt=""></p> <blockquote><p>å½“ä½ è¦å­¦ä¹ ä¸€ä¸ªæ–°äº‹ç‰©çš„æ—¶å€™ï¼Œä½ åº”è¯¥åšçš„ç¬¬ä¸€ä»¶äº‹å°±æ˜¯é—®è‡ªå·±ä¸¤ä¸ªé—®é¢˜</p></blockquote> <ul><li>ä¸ºä»€ä¹ˆä¼šå­˜åœ¨è¿™ä¸ªä¸œè¥¿ï¼Ÿ</li> <li>è¿™ä¸œè¥¿èƒ½è§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿ</li></ul> <p>å¦‚æœä½ ä»æ¥æ²¡æœ‰å¯¹è¿™ä¸¤ä¸ªé—®é¢˜éƒ½ç»™å‡ºä¸€ä¸ªä»¤äººä¿¡æœçš„ç­”æ¡ˆï¼Œé‚£ä¹ˆå½“ä½ æ·±å…¥åˆ°å…·ä½“é—®é¢˜æ—¶ï¼Œä½ å°±æ²¡æœ‰è¶³å¤Ÿçš„åšå®çš„åŸºç¡€ã€‚å…³äº React Hooksï¼Œè¿™äº›é—®é¢˜å€¼å¾—ä»¤äººæ€è€ƒã€‚å½“ Hooks å‘å¸ƒæ—¶ï¼ŒReact æ˜¯ JavaScript ç”Ÿæ€ç³»ç»Ÿä¸­æœ€æµè¡Œçš„ã€æœ€å—æ¬¢è¿çš„å‰ç«¯æ¡†æ¶ã€‚å°½ç®¡ React å·²ç»å—åˆ°é«˜åº¦èµæ‰¬ï¼ŒReact å›¢é˜Ÿä»ç„¶è®¤ä¸ºæœ‰å¿…è¦æ„å»ºå’Œå‘å¸ƒ Hooksã€‚åœ¨ä¸åŒçš„ Medium å¸–å­å’Œåšå®¢æ–‡ç« ä¸­çº·çº·è®®è®ºäº† 1.å°½ç®¡å—åˆ°é«˜åº¦èµæ‰¬å’Œå—æ¬¢è¿ï¼ŒReact å›¢é˜Ÿå†³å®šèŠ±è´¹å®è´µçš„çš„èµ„æºæ„å»ºå’Œå‘å¸ƒ Hooks æ˜¯ä¸ºäº†ä»€ä¹ˆï¼Ÿä»¥åŠ 2.å®ƒçš„å¥½å¤„ã€‚</p> <p>ä¸ºäº†æ›´å¥½çš„ç†è§£è¿™ä¸¤ä¸ªé—®é¢˜çš„ç­”æ¡ˆï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦æ›´æ·±å…¥çš„äº†è§£æˆ‘ä»¬è¿‡å»æ˜¯å¦‚ä½•ç¼–å†™ React åº”ç”¨ç¨‹åºçš„ã€‚</p> <h2 id="createclass"><a href="#createclass" aria-hidden="true" class="header-anchor">#</a> createClass</h2> <p>å¦‚æœä½ å·²ç»ä½¿ç”¨ React è¶³å¤Ÿä¹…ï¼Œä½ å°±ä¼šè®°å¾— React.createClassAPIã€‚è¿™æ˜¯æˆ‘ä»¬æœ€åˆåˆ›å»º React ç»„ä»¶çš„æ–¹å¼ã€‚ç”¨æ¥æè¿°ç»„ä»¶çš„æ‰€æœ‰ä¿¡æ¯éƒ½å°†ä½œä¸ºå¯¹è±¡ä¼ é€’ç»™<code>createClass</code>ã€‚</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> ReposGrid <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createClass</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token function">getInitialState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            repos<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            loading<span class="token punctuation">:</span><span class="token boolean">true</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateRepos</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>id<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">componentDidUpdate</span><span class="token punctuation">(</span><span class="token parameter">prevProps</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>prevProps<span class="token punctuation">.</span>id <span class="token operator">!==</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateRepos</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>id<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">updateRepos</span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>loading<span class="token punctuation">:</span><span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
        
        <span class="token function">fetchRepos</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">repos</span><span class="token operator">=&gt;</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            repos<span class="token punctuation">,</span>
            loading<span class="token punctuation">:</span> <span class="token boolean">false</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> <span class="token punctuation">{</span>loading<span class="token punctuation">,</span> repos<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state
        
        <span class="token keyword">if</span><span class="token punctuation">(</span>loading<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token operator">&lt;</span>Loading <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>ul<span class="token operator">&gt;</span>
        <span class="token punctuation">{</span>
        	repos<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>name<span class="token punctuation">,</span>handle<span class="token punctuation">,</span>stars<span class="token punctuation">,</span>url<span class="token punctuation">}</span></span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">(</span>
            	<span class="token operator">&lt;</span>li key<span class="token operator">=</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token operator">&gt;</span>
                	<span class="token operator">&lt;</span>ul<span class="token operator">&gt;</span>
                    	<span class="token operator">&lt;</span>li<span class="token operator">&gt;</span><span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token punctuation">{</span>url<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span>@<span class="token punctuation">{</span>handle<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span><span class="token punctuation">{</span>stars<span class="token punctuation">}</span> stars<span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
            <span class="token punctuation">)</span><span class="token punctuation">)</span>            
        <span class="token punctuation">}</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">&gt;</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br></div></div><p><code>createClass</code>æ˜¯åˆ›å»º React ç»„ä»¶çš„ä¸€ç§ç®€å•è€Œåˆæœ‰æ•ˆçš„æ–¹æ³•ã€‚React æœ€åˆä½¿ç”¨<code>createClassAPI</code>çš„åŸå› æ˜¯ï¼Œå½“æ—¶ JavaScript æ²¡æœ‰å†…ç½®çš„ç±»ç³»ç»Ÿã€‚å½“ç„¶ï¼Œè¿™æœ€ç»ˆæ”¹å˜äº†ã€‚åœ¨ ES6 ä¸­ï¼ŒJavaScript å¼•å…¥äº†<code>class</code> å…³é”®å­—ï¼Œå¹¶ä»¥åŸç”Ÿçš„æ–¹å¼åœ¨ JavaScript ä¸­åˆ›å»ºç±»ã€‚è¿™è¿«ä½¿ React å¤„äºä¸€ç§è¿›é€€ä¸¤éš¾çš„åœ°æ­¥ã€‚è¦ä¹ˆç»§ç»­ä½¿ç”¨<code>createClass</code>ï¼Œå¯¹æŠ— JavaScript çš„å‘å±•ï¼Œè¦ä¹ˆéµå¾ªECMAScript æ ‡å‡†ï¼Œæ‹¥æŠ±ç±»ã€‚å†å²è¡¨æ˜ï¼Œä»–ä»¬é€‰æ‹©äº†åè€…ã€‚</p> <h2 id="react-component"><a href="#react-component" aria-hidden="true" class="header-anchor">#</a> React.Component</h2> <blockquote><p>æˆ‘ä»¬å‘ç°æˆ‘ä»¬å¹¶ä¸æ˜¯æƒ³è¦å»è®¾è®¡ä¸€ä¸ªç±»ç³»ç»Ÿï¼Œæˆ‘ä»¬ä»…ä»…æ˜¯æƒ³è¦ä»¥æƒ¯ç”¨çš„ JavaScript æ–¹æ³•æ¥åˆ›å»ºç±»ã€‚â€”â€” React v0.13.0 Release</p></blockquote> <p>React v0.13.0 ä¸­å¼•å…¥äº†React.Component APIï¼Œå®ƒå…è®¸æˆ‘ä»¬ä»(ç°åœ¨)åŸç”Ÿ JavaScript ç±»ä¸­åˆ›å»º React ç»„ä»¶ã€‚è¿™æ˜¯ä¸€åœºå·¨å¤§çš„èƒœåˆ©ï¼Œå› ä¸ºå®ƒæ›´å¥½çš„ä¸ ECMAScript æ ‡å‡†ç»“åˆåœ¨äº†ä¸€èµ·ã€‚</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">ReposGrid</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span>
            repos<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            loading<span class="token punctuation">:</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>updateRepos <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateRepos</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
	<span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateRepos</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>id<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">componentDidUpdate</span><span class="token punctuation">(</span><span class="token parameter">prevProps</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>prevProps<span class="token punctuation">.</span>id <span class="token operator">!==</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateRepos</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>id<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token function">updateRepos</span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>loading<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token function">fetchRepos</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">repos</span><span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            loading<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            repos
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> <span class="token punctuation">{</span>loading<span class="token punctuation">,</span>repos<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state
       	<span class="token keyword">if</span><span class="token punctuation">(</span>loading<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token operator">&lt;</span>Loading <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
    	<span class="token operator">&lt;</span>ul<span class="token operator">&gt;</span>
    		<span class="token punctuation">{</span>
            	repos<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>name<span class="token punctuation">,</span>handle<span class="token punctuation">,</span>stars<span class="token punctuation">,</span>url<span class="token punctuation">}</span></span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">(</span>
                	<span class="token operator">&lt;</span>li key<span class="token operator">=</span><span class="token punctuation">{</span>namem<span class="token punctuation">}</span><span class="token operator">&gt;</span>
                    	<span class="token operator">&lt;</span>ul<span class="token operator">&gt;</span>
                        	<span class="token operator">&lt;</span>li<span class="token operator">&gt;</span><span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token punctuation">{</span>url<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
                            <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span>@<span class="token punctuation">{</span>handle<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
                            <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span><span class="token punctuation">{</span>stars<span class="token punctuation">}</span> stars<span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
                <span class="token punctuation">)</span><span class="token punctuation">)</span>
        	<span class="token punctuation">}</span>
    	<span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br></div></div><p>å°½ç®¡æœç€æ­£ç¡®çš„æ–¹å‘è¿ˆå‡ºäº†æ˜ç¡®çš„ä¸€æ­¥ï¼Œä½†è¿˜æ˜¯è¦åšå‡ºååº”ã€‚React.Component ä¸æ˜¯æ²¡æœ‰å®ƒçš„æƒè¡¡ã€‚</p> <h2 id="æ„é€ å‡½æ•°"><a href="#æ„é€ å‡½æ•°" aria-hidden="true" class="header-anchor">#</a> æ„é€ å‡½æ•°</h2> <p>ä½¿ç”¨ç±»ç»„ä»¶ï¼Œæ‚¨å¯ä»¥åœ¨<code>constructor</code>æ–¹æ³•å†…éƒ¨å°†ç»„ä»¶çš„çŠ¶æ€åˆå§‹åŒ–ä¸ºå®ä¾‹(this)ä¸Šçš„ state å±æ€§ã€‚ä½†æ˜¯ï¼Œæ ¹æ® ECMAScript è§„èŒƒï¼Œå¦‚æœè¦æ‰©å±•å­ç±»(è¿™é‡ŒæŒ‡çš„æ˜¯ React.Component)ï¼Œå¿…é¡»å…ˆè°ƒç”¨<code>super</code>å±æ€§ï¼Œç„¶åæ‰èƒ½ä½¿ç”¨ thisã€‚å…·ä½“æ¥è¯´ï¼Œå½“ä½¿ç”¨ React æ—¶ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è®°å¾—å°†<code>props</code>å±æ€§ä¼ é€’ç»™<code>super</code>ã€‚</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">constructor</span> <span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token comment">// ğŸ¤®</span>

    <span class="token operator">...</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="è‡ªåŠ¨ç»‘å®š"><a href="#è‡ªåŠ¨ç»‘å®š" aria-hidden="true" class="header-anchor">#</a> è‡ªåŠ¨ç»‘å®š</h2> <p>å½“ä½¿ç”¨<code>createClass</code>æ—¶ï¼ŒReact ä¼šè‡ªåŠ¨å°†æ‰€æœ‰æ–¹æ³•ç»‘å®šåœ¨ç»„ä»¶çš„å®ä¾‹ä¸Šï¼Œä¹Ÿå°±æ˜¯ <code>this</code>ã€‚å½“æœ‰äº† React.Component åï¼Œæƒ…å†µå°±ä¸åŒäº†ã€‚å¾ˆå¿«ï¼Œå„åœ°çš„ React å¼€å‘äººå‘˜éƒ½æ„è¯†åˆ°äº†ä»–ä»¬ä¸çŸ¥é“<code>this</code>å…³é”®å­—æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚æˆ‘ä»¬ä¸å¾—ä¸è®°ä½ç±»ä¸­çš„<code>constructor</code>ä¸­çš„<code>bind</code>æ–¹æ³•ã€‚å¦‚æœä½ ä¸è¿™æ ·åšï¼Œåˆ™ä¼šå‡ºç°ç»å¸¸å‡ºç°çš„é”™è¯¯ <strong>Cannot read property <code>setState</code> of undefined</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token function">constructor</span> <span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span>updateRepos <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateRepos</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token comment">// ğŸ˜­</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>ç°åœ¨æˆ‘å¤§æ¦‚èƒ½çŒœåˆ°ä½ ä»¬åœ¨æƒ³ä»€ä¹ˆã€‚é¦–å…ˆï¼Œè¿™äº›é—®é¢˜ç›¸å½“è‚¤æµ…ã€‚å½“ç„¶ï¼Œè°ƒç”¨ super(props) å¹¶è®°ä½<code>bind</code>æ–¹æ³•æ˜¯ç›¸å½“çƒ¦äººçš„ã€‚ä½†è¿™é‡Œå…¶å®å¹¶æ²¡æœ‰ä»€ä¹ˆæ ¹æœ¬é”™è¯¯ã€‚å…¶æ¬¡ï¼Œè¿™äº›é—®é¢˜å¹¶ä¸åƒ JavaScript ç±»çš„è®¾è®¡æ–¹å¼é‚£æ ·ä¸¥é‡ã€‚å½“ç„¶è¿™ä¸¤ç‚¹éƒ½æ˜¯æ¯‹åº¸ç½®ç–‘çš„ã€‚ç„¶è€Œï¼Œå¯¹äºæˆ‘ä»¬å¼€å‘äººå‘˜æ¥è¯´ï¼Œå³ä¾¿æ˜¯å†æµ…æ˜¾çš„é—®é¢˜ï¼Œå½“ä½ ä¸€å¤©è¦å¤„ç† 20 å¤šæ¬¡ç”šè‡³æ›´å¤šçš„æ—¶å€™ï¼Œä¹Ÿä¼šå˜å¾—éå¸¸åŒæ¶ã€‚å¹¸è¿çš„æ˜¯ï¼Œåœ¨ä» createClass åˆ‡æ¢åˆ° React.Component åä¸ä¹…ï¼Œç±»å­—æ®µå‡ºå°äº†ã€‚</p> <h2 id="ç±»å­—æ®µ"><a href="#ç±»å­—æ®µ" aria-hidden="true" class="header-anchor">#</a> ç±»å­—æ®µ</h2> <p>ç±»å­—æ®µå…è®¸æˆ‘ä»¬ç›´æ¥å°†å®ä¾‹å±æ€§ä½œä¸ºå±æ€§æ·»åŠ åˆ°ç±»ä¸Šï¼Œè€Œæ— éœ€ä½¿ç”¨<code>constructor</code>ã€‚è¿™å¯¹æˆ‘ä»¬æ¥è¯´ï¼Œæ„å‘³ç€ï¼Œä½¿ç”¨ç±»å­—æ®µï¼Œæˆ‘ä»¬ä¹‹å‰æ‰€è®¨è®ºçš„ä¸¤ä¸ª<code>æµ…æ˜¾</code>çš„é—®é¢˜éƒ½å°†è¿åˆƒè€Œè§£ã€‚æˆ‘ä»¬ä¸å†éœ€è¦ä½¿ç”¨<code>constructor</code>æ¥è®¾ç½®ç»„ä»¶çš„åˆå§‹çŠ¶æ€ï¼Œä¹Ÿä¸å†éœ€è¦åœ¨<code>constructor</code>ä¸­ä½¿ç”¨<code>bind</code>å‡½æ•°ï¼Œå› ä¸ºæˆ‘ä»¬å®Œå…¨å¯ä»¥ä¸ºæ–¹æ³•ä½¿ç”¨ç®­å¤´å‡½æ•°ã€‚</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">ReposGrid</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span>
    repos<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    loading<span class="token punctuation">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
  <span class="token function">componentDidMount</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateRepos</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>id<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token function">componentDidUpdate</span> <span class="token punctuation">(</span><span class="token parameter">prevProps</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>prevProps<span class="token punctuation">.</span>id <span class="token operator">!==</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateRepos</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>id<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token function-variable function">updateRepos</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> loading<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token function">fetchRepos</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">repos</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        repos<span class="token punctuation">,</span>
        loading<span class="token punctuation">:</span> <span class="token boolean">false</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> loading<span class="token punctuation">,</span> repos <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state

    <span class="token keyword">if</span> <span class="token punctuation">(</span>loading <span class="token operator">===</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token operator">&lt;</span>Loading <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>ul<span class="token operator">&gt;</span>
        <span class="token punctuation">{</span>repos<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> name<span class="token punctuation">,</span> handle<span class="token punctuation">,</span> stars<span class="token punctuation">,</span> url <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
          <span class="token operator">&lt;</span>li key<span class="token operator">=</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>ul<span class="token operator">&gt;</span>
              <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span><span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token punctuation">{</span>url<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
              <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span>@<span class="token punctuation">{</span>handle<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
              <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span><span class="token punctuation">{</span>stars<span class="token punctuation">}</span> stars<span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
        <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><p>æ‰€æœ‰é—®é¢˜éƒ½è§£å†³äº†ï¼Œæ˜¯å—ï¼Ÿä¸å¹¸çš„æ˜¯ï¼Œå¹¶æ²¡æœ‰ã€‚ä»<code>createClass</code>åˆ° React.Component çš„è¿ç§»è¿‡ç¨‹ä¸­ï¼Œ</p> <p>ç»„ä»¶å¸¦æœ‰ä¸€äº›æƒè¡¡ï¼Œä½†æ­£å¦‚æˆ‘ä»¬æ‰€çœ‹åˆ°çš„ï¼Œç±»å­—æ®µç¡®å®è§£å†³äº†ä¸€äº›é—®é¢˜ã€‚ä¸å¹¸çš„æ˜¯ï¼Œåœ¨æˆ‘ä»¬æ‰€è§è¿‡çš„æ‰€æœ‰ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ï¼Œä»ç„¶å­˜åœ¨ç€ä¸€äº›æ›´æ·±åˆ»(ä½†å¾ˆå°‘æåŠ)çš„é—®é¢˜ã€‚</p> <p>React çš„æ•´ä½“ç†å¿µæ—¶ï¼Œé€šè¿‡å°†åº”ç”¨ç¨‹åºåˆ†è§£ä¸ºå¯ä»¥ç»„åˆåœ¨ä¸€èµ·çš„ç‹¬ç«‹ç»„ä»¶ï¼Œå¯ä»¥æ›´å¥½åœ°ç®¡ç†åº”ç”¨ç¨‹åºçš„å¤æ‚æ€§ã€‚æ­£æ˜¯è¿™ç§ç»„ä»¶æ¨¡å‹ä½¿å¾— React å¦‚æ­¤ä¼˜é›…ï¼Œä¹Ÿä½¿å¾— React å¦‚æ­¤çš„ç‹¬ä¸€æ— äºŒã€‚ç„¶è€Œï¼Œé—®é¢˜ä¸åœ¨äºç»„ä»¶æ¨¡å‹ï¼Œè€Œæ˜¯å¦‚ä½•å®ç°ç»„ä»¶æ¨¡å‹ã€‚</p> <h2 id="é‡å¤é€»è¾‘"><a href="#é‡å¤é€»è¾‘" aria-hidden="true" class="header-anchor">#</a> é‡å¤é€»è¾‘</h2> <p>è¿‡å»ï¼Œæˆ‘ä»¬æ„å»ºçš„ React ç»„ä»¶çš„æ–¹å¼ä¸ç»„ä»¶çš„å£°æ˜å‘¨æœŸæ˜¯è€¦åˆçš„ã€‚è¿™ç§åˆ’åˆ†è‡ªç„¶è€Œç„¶çš„è¿«ä½¿æˆ‘ä»¬åœ¨æ•´ä¸ªç»„ä»¶ä¸­æ•£å¸ƒç€ç›¸å…³é€»è¾‘ã€‚åœ¨æˆ‘ä»¬çš„æ‰€ä½¿ç”¨çš„ ReposGrid ç»„ä»¶ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆæ¸…æ¥šçš„äº†è§£åˆ°è¿™ä¸€ç‚¹ã€‚æˆ‘ä»¬éœ€è¦ä¸‰ä¸ªå•ç‹¬çš„æ–¹æ³•<code>componentDidMountã€componentDidUpdateå’ŒupdateRepos</code>æ¥å®Œæˆç›¸åŒçš„ä»»åŠ¡â€”â€”ä½¿<code>repos</code>ä¸ä»»ä½• <code>props.id</code>ä¿æŒåŒæ­¥ã€‚</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">componentDidMount</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateRepos</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>id<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token function">componentDidUpdate</span> <span class="token punctuation">(</span><span class="token parameter">prevProps</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>prevProps<span class="token punctuation">.</span>id <span class="token operator">!==</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateRepos</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>id<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token function-variable function">updateRepos</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> loading<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token function">fetchRepos</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">repos</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        repos<span class="token punctuation">,</span>
        loading<span class="token punctuation">:</span> <span class="token boolean">false</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªå…¨æ–°çš„æ–¹å¼æ¥å¤„ç† React ç»„ä»¶ä¸­çš„å‰¯ä½œç”¨ã€‚</p> <h2 id="å…±äº«éå¯è§†é€»è¾‘"><a href="#å…±äº«éå¯è§†é€»è¾‘" aria-hidden="true" class="header-anchor">#</a> å…±äº«éå¯è§†é€»è¾‘</h2> <p>å½“ä½ åœ¨ React ä¸­è€ƒè™‘æ„å›¾æ—¶ï¼Œä½ å¾ˆæœ‰å¯èƒ½ä¼šè€ƒè™‘ UI æ„å›¾ã€‚è¿™æ˜¯å¾ˆæ­£å¸¸çš„ï¼Œå› ä¸ºè¿™æ­£æ˜¯ React æ‰€æ“…é•¿çš„ã€‚</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>view <span class="token operator">=</span> <span class="token function">fn</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>å®é™…ä¸Šï¼Œæ„å»ºä¸€ä¸ªåº”ç”¨ç¨‹åºä¸ä»…ä»…æ˜¯ UI å±‚é¢çš„ã€‚éœ€è¦ç»„åˆå’Œéå¯è§†é€»è¾‘çš„åœ°æ–¹å¹¶ä¸å°‘è§ã€‚ä½†æ˜¯ï¼Œå› ä¸º React å°† UI ä¸ç»„ä»¶è€¦åˆèµ·æ¥ï¼Œæ‰€ä»¥è¿™å¯èƒ½ä¼šæ¯”è¾ƒå›°éš¾ã€‚åˆ°ç›®å‰ä¸ºæ­¢ï¼ŒReact å¹¶æ²¡æœ‰ç»™å‡ºä¸€ä¸ªå¾ˆå¥½çš„è§£å†³æ–¹æ¡ˆã€‚</p> <p>ç»§ç»­çœ‹æˆ‘ä»¬çš„ç¤ºä¾‹ï¼Œå‡è®¾æˆ‘ä»¬éœ€è¦å¦ä¸€ä¸ªåŒæ ·éœ€è¦<code>repos</code> çŠ¶æ€çš„ç»„ä»¶ã€‚ç°åœ¨ï¼Œè¯¥çŠ¶æ€å’Œå¤„ç†å®ƒçš„é€»è¾‘ä½äº ReposGrid ç»„ä»¶ä¸­ã€‚æˆ‘ä»¬è¯¥å¦‚ä½•åšå‘¢ï¼Ÿæœ€ç®€å•çš„æ–¹å¼å°±æ˜¯å¤åˆ¶æ‰€æœ‰ç”¨äºè·å–å’Œå¤„ç†<code>repos</code>çš„é€»è¾‘ï¼Œå¹¶å°†å…¶ç²˜è´´åˆ°æ–°ç»„ä»¶ä¸­ã€‚å¬èµ·æ¥è¿˜ä¸é”™ï¼Œä½†å®ƒå¹¶ä¸æ˜¯ä¸€ä¸ªå¥½çš„æ–¹æ¡ˆã€‚ä¸€ä¸ªæ›´èªæ˜çš„æ–¹æ³•æ˜¯åˆ›å»ºä¸€ä¸ªé«˜é˜¶ç»„ä»¶ï¼Œå®ƒå°è£…äº†æ‰€æœ‰çš„å…±äº«é€»è¾‘ï¼Œå¹¶å°†<code>loading</code>å’Œ<code>repos</code>ä½œä¸º<code>props</code>ä¼ é€’ç»™ä»»ä½•éœ€è¦å®ƒçš„ç»„ä»¶ã€‚</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">withRepos</span> <span class="token punctuation">(</span><span class="token parameter">Component</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">class</span> <span class="token class-name">WithRepos</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
    state <span class="token operator">=</span> <span class="token punctuation">{</span>
      repos<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      loading<span class="token punctuation">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
    <span class="token function">componentDidMount</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateRepos</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>id<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">componentDidUpdate</span> <span class="token punctuation">(</span><span class="token parameter">prevProps</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>prevProps<span class="token punctuation">.</span>id <span class="token operator">!==</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateRepos</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>id<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token function-variable function">updateRepos</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> loading<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

      <span class="token function">fetchRepos</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">repos</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          repos<span class="token punctuation">,</span>
          loading<span class="token punctuation">:</span> <span class="token boolean">false</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">render</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>Component
          <span class="token punctuation">{</span><span class="token operator">...</span>this<span class="token punctuation">.</span>props<span class="token punctuation">}</span>
          <span class="token punctuation">{</span><span class="token operator">...</span>this<span class="token punctuation">.</span>state<span class="token punctuation">}</span>
        <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><p>å½“åº”ç”¨ç¨‹åºä¸­çš„ä»»ä½•ç»„ä»¶éœ€è¦<code>repos</code>(æˆ–åŠ è½½)æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶å°è£…åœ¨ withRepos HOC ä¸­ã€‚</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// ReposGrid.js</span>
<span class="token keyword">function</span> <span class="token function">ReposGrid</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> loading<span class="token punctuation">,</span> repos <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">withRepos</span><span class="token punctuation">(</span>ReposGrid<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// Profile.js</span>
<span class="token keyword">function</span> <span class="token function">Profile</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> loading<span class="token punctuation">,</span> repos <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">withRepos</span><span class="token punctuation">(</span>Profile<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>è¿™æ˜¯å¯è¡Œçš„ï¼Œè€Œä¸”å®ƒåŠ ä¸Š Render Props ä¸€ç›´æ˜¯æœ€ä½³çš„å…±äº«éå¯è§†é€»è¾‘çš„è§£å†³æ–¹æ¡ˆã€‚ç„¶è€Œï¼Œè¿™ä¸¤ç§æ¨¡å¼éƒ½æœ‰ä¸€äº›ç¼ºç‚¹ã€‚</p> <p>é¦–å…ˆï¼Œå¦‚æœä½ ä¸å¤Ÿç†Ÿæ‚‰å®ƒä»¬(å³ä½¿ä½ ç†Ÿæ‚‰)ï¼Œä½ ä¼šæœ‰ç‚¹å‘æ‡µã€‚ä½¿ç”¨ withRepos  HOC ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒä»¥æœ€ç»ˆå‘ˆç°çš„ç»„ä»¶ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ï¼Œä½†è¿”å›ä¸€ä¸ªæ–°çš„ç±»ç»„ä»¶ï¼Œè¿™å°±æ˜¯é€»è¾‘æ‰€åœ¨ã€‚ä¸€ä¸ªå¤šä¹ˆå¤æ‚çš„è¿‡ç¨‹å•Šã€‚æ¥ä¸‹æ¥ï¼Œå¦‚æœæˆ‘ä»¬è°ƒç”¨å¤šä¸ª HOCï¼Œåˆä¼šæ€ä¹ˆæ ·å‘¢ï¼Ÿä½ å¯ä»¥æƒ³è±¡ï¼Œå®ƒå¾ˆå¿«å°±å¤±æ§äº†ã€‚</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">withHover</span><span class="token punctuation">(</span>
  <span class="token function">withTheme</span><span class="token punctuation">(</span>
    <span class="token function">withAuth</span><span class="token punctuation">(</span>
      <span class="token function">withRepos</span><span class="token punctuation">(</span>Profile<span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>æ¯”è¿™æ›´ç³Ÿçš„æ˜¯æœ€ç»ˆå¾—åˆ°çš„ç»“æœã€‚HOCs(å’Œç±»ä¼¼çš„æ¨¡å¼)è¿«ä½¿æˆ‘ä»¬å¿…é¡»é‡æ–°æ„é€ å’ŒåŒ…è£…ç»„ä»¶ã€‚è¿™æœ€ç»ˆå¯èƒ½å¯¼è‡´<code>åŒ…è£…åœ°ç‹±</code>ï¼Œè¿™åˆä¸€æ¬¡ä½¿å®ƒæ›´éš¾éµå¾ªã€‚</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span>WithHover<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>WithTheme hovering<span class="token operator">=</span><span class="token punctuation">{</span><span class="token boolean">false</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>WithAuth hovering<span class="token operator">=</span><span class="token punctuation">{</span><span class="token boolean">false</span><span class="token punctuation">}</span> theme<span class="token operator">=</span><span class="token string">'dark'</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>WithRepos hovering<span class="token operator">=</span><span class="token punctuation">{</span><span class="token boolean">false</span><span class="token punctuation">}</span> theme<span class="token operator">=</span><span class="token string">'dark'</span> authed<span class="token operator">=</span><span class="token punctuation">{</span><span class="token boolean">true</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>Profile 
          id<span class="token operator">=</span><span class="token string">'JavaScript'</span>
          loading<span class="token operator">=</span><span class="token punctuation">{</span><span class="token boolean">true</span><span class="token punctuation">}</span> 
          repos<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
          authed<span class="token operator">=</span><span class="token punctuation">{</span><span class="token boolean">true</span><span class="token punctuation">}</span>
          theme<span class="token operator">=</span><span class="token string">'dark'</span>
          hovering<span class="token operator">=</span><span class="token punctuation">{</span><span class="token boolean">false</span><span class="token punctuation">}</span>
        <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>WithRepos<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>WithAuth<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>WithTheme<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>WithHover<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h2 id="ç°çŠ¶"><a href="#ç°çŠ¶" aria-hidden="true" class="header-anchor">#</a> ç°çŠ¶</h2> <p>è¿™å°±æ˜¯æˆ‘ä»¬æ‰€å¤„çš„ç°çŠ¶ã€‚</p> <ul><li>React å¾ˆå—æ¬¢è¿ã€‚</li> <li>æˆ‘ä»¬ä¸º React ç»„ä»¶ä½¿ç”¨ç±»ï¼Œå› ä¸ºè¿™åœ¨å½“æ—¶å¾ˆæœ‰æ„ä¹‰ã€‚</li> <li>è°ƒç”¨<code>super(props)</code>å¾ˆçƒ¦äººã€‚</li> <li>æ²¡äººçŸ¥é“<code>this</code>æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚</li> <li>okï¼Œå†·é™ä¸€ä¸‹ã€‚æˆ‘çŸ¥é“ä½ æ˜ç™½<code>this</code>æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œä½†å¯¹äºæœ‰äº›äººæ¥è¯´ï¼Œè¿™æ˜¯ä¸€ä¸ªä¸å¿…è¦çš„éšœç¢ã€‚</li> <li>æŒ‰ç…§ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ç»„ç»‡ç»„ä»¶è¿«ä½¿æˆ‘ä»¬åœ¨ç»„ä»¶ä¸­æ•£å¸ƒç€ç›¸å…³çš„é€»è¾‘ã€‚</li> <li>React æ²¡æœ‰ç”¨äºå…±äº«éå¯è§†é€»è¾‘çš„è‰¯å¥½åŸè¯­ã€‚</li></ul> <p>ç°åœ¨ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ–°çš„ç»„ä»¶ API æ¥è§£å†³æ‰€æœ‰è¿™äº›é—®é¢˜ï¼ŒåŒæ—¶ä¿æŒç®€å•ã€å¯ç»„åˆã€çµæ´»å’Œå¯æ‰©å±•ã€‚è¿™ä¸ªä»»åŠ¡å¾ˆè‰°å·¨ï¼Œä½†æ˜¯ React å›¢é˜Ÿè¿˜æ˜¯æˆåŠŸäº†ã€‚</p> <h2 id="react-hooks"><a href="#react-hooks" aria-hidden="true" class="header-anchor">#</a> React Hooks</h2> <p>ä» React v0.14.0 å¼€å§‹ï¼Œæˆ‘ä»¬æœ‰ä¸¤ç§æ–¹å¼æ¥åˆ›å»ºç»„ä»¶â€”â€”ç±»å’Œå‡½æ•°ã€‚ä¸åŒä¹‹å¤„åœ¨äºï¼Œå¦‚æœæˆ‘ä»¬çš„ç»„ä»¶æœ‰çŠ¶æ€æˆ–è€…éœ€è¦ä½¿ç”¨ç”Ÿå‘½å‘¨æœŸæ–¹æ³•çš„è¯ï¼Œæˆ‘ä»¬å°±å¿…é¡»ä½¿ç”¨ç±»ã€‚å¦åˆ™ï¼Œå¦‚æœå®ƒåªæ˜¯æ¥å—<code>props</code>å¹¶å‘ˆç°ä¸€äº› UIï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨å‡½æ•°ã€‚</p> <p>é‚£ä¹ˆï¼Œå¦‚æœä¸æ˜¯è¿™æ ·å‘¢ï¼Ÿå¦‚æœæˆ‘ä»¬ä¸ä½¿ç”¨ç±»ï¼Œè€Œæ˜¯åªä½¿ç”¨å‡½æ•°ï¼Œåˆè¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ</p> <blockquote><p>æœ‰æ—¶å€™ï¼Œä¼˜é›…çš„å®ç°åªæ˜¯ä¸€ä¸ªå‡½æ•°ã€‚ä¸æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œä¸æ˜¯ä¸€ä¸ªç±»ã€‚ä¸æ˜¯ä¸€ä¸ªæ¡†æ¶ã€‚åªæ˜¯ä¸€ä¸ªå‡½æ•°ã€‚â€”â€” John Carmack. Oculus VR é¦–å¸­æŠ€æœ¯å®˜</p></blockquote> <p>å½“ç„¶ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°ä¸€ç§æ–¹æ³•æ¥æ·»åŠ åŠŸèƒ½ç»„ä»¶ï¼Œä½¿å…¶æ‹¥æœ‰çŠ¶æ€å’Œç”Ÿå‘½å‘¨æœŸæ–¹æ³•çš„èƒ½åŠ›ï¼Œä½†æ˜¯å‡è®¾æˆ‘ä»¬è¿™æ ·åšäº†ï¼Œæˆ‘ä»¬åˆèƒ½å¾—åˆ°ä»€ä¹ˆå¥½å¤„å‘¢ï¼Ÿ</p> <p>æˆ‘ä»¬ä¸å†éœ€è¦è°ƒç”¨<code>super(props)</code>ï¼Œä¸å†éœ€è¦æ‹…å¿ƒç»‘å®šæ–¹æ³•æˆ–<code>this</code>å…³é”®å­—ï¼Œä¹Ÿä¸å†éœ€è¦ä½¿ç”¨ç±»å­—æ®µã€‚æœ¬è´¨ä¸Šï¼Œæˆ‘ä»¬ä¹‹å‰è®¨è®ºçš„æ‰€æœ‰<code>è¡¨é¢</code>é—®é¢˜éƒ½ä¼šè§£å†³ã€‚</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">(</span>ãƒà²¥<span class="token punctuation">,</span>_ï½£à²¥<span class="token punctuation">)</span>ãƒå½¡ React<span class="token punctuation">.</span>Component ğŸ—‘

<span class="token keyword">function</span> <span class="token function">ãƒ¾</span><span class="token punctuation">(</span><span class="token parameter">Åâ€¿Åâœ¿</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>å¥½å§ï¼Œç°åœ¨ï¼Œæ›´æ£˜æ‰‹çš„é—®é¢˜æ‘†åœ¨é¢å‰ã€‚</p> <ul><li>çŠ¶æ€</li> <li>ç”Ÿå‘½å‘¨æœŸå‡½æ•°</li> <li>å…±äº«éå¯è§†é€»è¾‘</li></ul> <h3 id="çŠ¶æ€"><a href="#çŠ¶æ€" aria-hidden="true" class="header-anchor">#</a> çŠ¶æ€</h3> <p>ç”±äºæˆ‘ä»¬ä¸å†ä½¿ç”¨ç±»æˆ–<code>this</code>ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§æ–°çš„æ–¹æ³•æ¥æ·»åŠ å’Œç®¡ç†ç»„ä»¶çš„å†…éƒ¨çŠ¶æ€ã€‚React v16.8.0 é€šè¿‡ useState ä¸ºæˆ‘ä»¬æä¾›äº†è¿™ç§æ–°æ–¹æ³•ã€‚</p> <blockquote><p>useState æ˜¯æˆ‘ä»¬åœ¨æœ¬è¯¾ç¨‹ä¸­çœ‹åˆ°çš„ä¼—å¤š Hooks ä¸­çš„ç¬¬ä¸€ä¸ªã€‚è®©è¿™ç¯‡æ–‡ç« çš„å…¶ä½™éƒ¨åˆ†åšä¸€ä¸ªç®€å•çš„ä»‹ç»ã€‚åœ¨ä¹‹åçš„ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†æ›´åŠ æ·±å…¥çš„ç ”ç©¶ useState å’Œå…¶ä»–çš„ Hooksã€‚</p></blockquote> <p>useState åªæ¥å—ä¸€ä¸ªå‚æ•°ï¼Œå³çŠ¶æ€çš„åˆå§‹å€¼ã€‚å®ƒè¿”å›çš„æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå…¶ä¸­ç¬¬ä¸€é¡¹æ˜¯çŠ¶æ€å—(ä¹Ÿå°±æ˜¯æ›´æ”¹åçš„çŠ¶æ€å€¼ï¼Œç±»ä¼¼äºåœ¨ this.stateä¸­å®šä¹‰çš„çŠ¶æ€å€¼)ï¼Œç¬¬äºŒé¡¹æ˜¯æ›´æ–°æ”¹çŠ¶æ€çš„å‡½æ•°(ç”¨æ¥æ”¹å˜çŠ¶æ€ï¼Œç±»ä¼¼äºthis.setState())ã€‚</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> loadingTuple <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> loading <span class="token operator">=</span> loadingTuple<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
<span class="token keyword">const</span> setLoading <span class="token operator">=</span> loadingTuple<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>

<span class="token operator">...</span>

loading <span class="token comment">// true</span>
<span class="token function">setLoading</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
loading <span class="token comment">// false</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>æ­£å¦‚æˆ‘ä»¬æ‰€çœ‹åˆ°çš„ï¼Œå•ç‹¬è·å–æ•°ç»„ä¸­çš„æ¯ä¸€é¡¹å¹¶ä¸æ˜¯æœ€ä½³çš„å¼€å‘äººå‘˜ä½“éªŒã€‚è¿™æ˜¯ä¸ºäº†æ¼”ç¤º useState å¦‚ä½•è¿”å›æ•°ç»„ã€‚é€šå¸¸ï¼Œæˆ‘ä»¬ä¼šé‡‡ç”¨æ•°ç»„ææ„çš„æ–¹å¼åœ¨ä¸€è¡Œä¸­è·å–å€¼ã€‚</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// const loadingTuple = React.useState(true)</span>
<span class="token comment">// const loading = loadingTuple[0]</span>
<span class="token comment">// const setLoading = loadingTuple[1]</span>

<span class="token keyword">const</span> <span class="token punctuation">[</span> loading<span class="token punctuation">,</span> setLoading <span class="token punctuation">]</span> <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token comment">// ğŸ‘Œ</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨æ–°å­¦ä¹ çš„æœ‰å…³äº useState é’©å­çš„çŸ¥è¯†æ¥æ›´æ–° ReposGrid ç»„ä»¶ã€‚</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">ReposGrid</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> id <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span> repos<span class="token punctuation">,</span> setRepos <span class="token punctuation">]</span> <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span> loading<span class="token punctuation">,</span> setLoading <span class="token punctuation">]</span> <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>loading <span class="token operator">===</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>Loading <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>ul<span class="token operator">&gt;</span>
      <span class="token punctuation">{</span>repos<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> name<span class="token punctuation">,</span> handle<span class="token punctuation">,</span> stars<span class="token punctuation">,</span> url <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>li key<span class="token operator">=</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>ul<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span><span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token punctuation">{</span>url<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span>@<span class="token punctuation">{</span>handle<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span><span class="token punctuation">{</span>stars<span class="token punctuation">}</span> stars<span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
      <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><ul><li>çŠ¶æ€ âœ…</li> <li>ç”Ÿå‘½å‘¨æœŸå‡½æ•°</li> <li>å…±äº«éå¯è§†é€»è¾‘</li></ul> <h3 id="ç”Ÿå‘½å‘¨æœŸå‡½æ•°"><a href="#ç”Ÿå‘½å‘¨æœŸå‡½æ•°" aria-hidden="true" class="header-anchor">#</a> ç”Ÿå‘½å‘¨æœŸå‡½æ•°</h3> <p>ç°åœ¨ï¼Œæœ‰äº›äº‹æƒ…å¯èƒ½ä¼šè®©ä½ æ„Ÿåˆ°éš¾è¿‡(æˆ–å¼€å¿ƒ?)ã€‚åœ¨ä½¿ç”¨ React Hooks æ—¶ï¼Œæˆ‘å¸Œæœ›ä½ èƒ½å¤Ÿå°†ä½ æ‰€çŸ¥é“çš„å…³äºä¼ ç»Ÿ React ç”Ÿå‘½å‘¨æœŸå‡½æ•°ä»¥åŠè¿™ç§æ€ç»´æ–¹å¼çš„æ‰€æœ‰ç›¸å…³çŸ¥è¯†éƒ½å¿˜æ‰ã€‚æˆ‘ä»¬å·²ç»çœ‹åˆ°äº†è€ƒè™‘ç»„ä»¶ç”Ÿå‘½å‘¨æœŸçš„é—®é¢˜â€”â€”__è¿™ä¸ªã€ç”Ÿå‘½å‘¨æœŸã€‘åˆ’åˆ†è‡ªç„¶è€Œç„¶çš„è¿«ä½¿æˆ‘ä»¬åœ¨ç»„ä»¶ä¸­æ•£å¸ƒç€ç›¸å…³çš„é€»è¾‘ã€‚__ç›¸åï¼Œè€ƒè™‘åŒæ­¥ã€‚</p> <p>æ€è€ƒä¸€ä¸‹ä½ æ›¾ç»ä½¿ç”¨è¿‡çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ã€‚æ— è®ºæ˜¯è®¾ç½®ç»„ä»¶çš„åˆå§‹çŠ¶æ€ã€è·å–æ•°æ®ã€æ›´æ–°DOMï¼Œè¿˜æ˜¯åšä»»ä½•äº‹æƒ…â€”â€”æœ€ç»ˆç›®æ ‡æ€»æ˜¯åŒæ­¥ã€‚é€šå¸¸ï¼ŒåŒæ­¥ React land(API è¯·æ±‚ã€DOMç­‰)å¤–éƒ¨çš„å†…å®¹å’Œ React land(ç»„ä»¶çŠ¶æ€)å†…éƒ¨çš„å†…å®¹ï¼Œåä¹‹äº¦ç„¶ã€‚</p> <p>å½“æˆ‘ä»¬è€ƒè™‘åŒæ­¥è€Œä¸æ˜¯ç”Ÿå‘½å‘¨æœŸå‡½æ•°æ—¶ï¼Œå®ƒå…è®¸æˆ‘ä»¬å°†ç›¸å…³çš„é€»è¾‘ç‰‡æ®µç»„åˆåœ¨ä¸€èµ·ã€‚ä¸ºæ­¤ï¼ŒReact æä¾›äº†å¦ä¸€ä¸ªé’©å­â€”â€”useEffectã€‚</p> <p>å®šä¹‰åï¼ŒuseEffect å…è®¸æ‚¨åœ¨å‡½æ•°ç»„ä»¶ä¸­æ‰§è¡Œå‰¯ä½œç”¨ã€‚å®ƒæ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªå‡½æ•°å’Œä¸€ä¸ªå¯é€‰æ•°ç»„ã€‚å‡½æ•°å®šä¹‰è¦è¿è¡Œå“ªäº›å‰¯ä½œç”¨ï¼Œ(å¯é€‰)æ•°ç»„å®šä¹‰ä½•æ—¶__é‡æ–°åŒæ­¥(æˆ–é‡æ–°è¿è¡Œ)__ç»“æœã€‚</p> <p>æ³¨ï¼šè¯¥å‡½æ•°ä¼šåœ¨ç»„ä»¶åŠ è½½æœŸé—´é¦–æ¬¡è¿è¡Œï¼Œéšåé€šè¿‡ç›‘å¬å¯é€‰æ•°ç»„ä¸­ä¼ å…¥çš„å‚æ•°å˜åŒ–ï¼Œæ›´æ–°å‡½æ•°ä»¥é‡æ–°åŒæ­¥ã€‚</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>React<span class="token punctuation">.</span><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  document<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Hello, </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>username<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>username<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œä¼ é€’ç»™ useEffect çš„å‡½æ•°å°†åœ¨ç”¨æˆ·åå‘ç”Ÿæ”¹å˜æ—¶è¿è¡Œã€‚å› æ­¤ï¼Œå°†æ–‡æ¡£çš„æ ‡é¢˜ä¸<code>Helloã€${username}</code>è§£æä¸ºå†…å®¹åŒæ­¥ã€‚</p> <p>ç°åœ¨ï¼Œæˆ‘ä»¬å¦‚ä½•ä½¿ç”¨ä»£ç ä¸­çš„ useEffect é’©å­æ¥åŒæ­¥<code>repos</code>å’Œ fetchRepos API è¯·æ±‚ï¼Ÿ</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">ReposGrid</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> id <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span> repos<span class="token punctuation">,</span> setRepos <span class="token punctuation">]</span> <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span> loading<span class="token punctuation">,</span> setLoading <span class="token punctuation">]</span> <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>

  React<span class="token punctuation">.</span><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setLoading</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>

    <span class="token function">fetchRepos</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">repos</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">setRepos</span><span class="token punctuation">(</span>repos<span class="token punctuation">)</span>
        <span class="token function">setLoading</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">)</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>loading <span class="token operator">===</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>Loading <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>ul<span class="token operator">&gt;</span>
      <span class="token punctuation">{</span>repos<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> name<span class="token punctuation">,</span> handle<span class="token punctuation">,</span> stars<span class="token punctuation">,</span> url <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>li key<span class="token operator">=</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>ul<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span><span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token punctuation">{</span>url<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span>@<span class="token punctuation">{</span>handle<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span><span class="token punctuation">{</span>stars<span class="token punctuation">}</span> stars<span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
      <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><p>å¾ˆé¡ºç•…ï¼Œä¸æ˜¯å—ï¼Ÿæˆ‘ä»¬å·²ç»æˆåŠŸçš„æ‘†è„±äº† React.Componentã€<code>constructor</code>ã€<code>super</code>ï¼Œæ›´é‡è¦çš„æ˜¯ï¼Œæˆ‘ä»¬ä¸å†åœ¨ç»„ä»¶ä¸­æ•£å¸ƒ(å’Œå¤åˆ¶)<code>effect</code>é€»è¾‘äº†ã€‚</p> <ul><li>çŠ¶æ€âœ…</li> <li>ç”Ÿå‘½å‘¨æœŸå‡½æ•°âœ…</li> <li>å…±äº«éå¯è§†é€»è¾‘</li></ul> <h3 id="å…±äº«éå¯è§†é€»è¾‘-2"><a href="#å…±äº«éå¯è§†é€»è¾‘-2" aria-hidden="true" class="header-anchor">#</a> å…±äº«éå¯è§†é€»è¾‘</h3> <p>å‰é¢æˆ‘ä»¬æåˆ°è¿‡ï¼ŒReact å¯¹å…±äº«éå¯è§†é€»è¾‘æ²¡æœ‰å¾ˆå¥½çš„è§£å†³æ–¹æ¡ˆçš„åŸå› æ˜¯__React å°† UI å’Œç»„ä»¶è€¦åˆåœ¨äº†ä¸€èµ·__ã€‚è¿™å¯¼è‡´äº†åƒé«˜é˜¶ç»„ä»¶æˆ– Render Props è¿™æ ·è¿‡äºå¤æ‚çš„æ¨¡å¼ã€‚ç°åœ¨ä½ ä¸€å®šçŒœåˆ°äº†ï¼ŒHooks å¯¹æ­¤ä¹Ÿæœ‰äº†ä¸€ä¸ªç­”æ¡ˆã€‚ç„¶è€Œï¼Œè¿™å¯èƒ½è·Ÿä½ æƒ³è±¡ä¸­çš„æœ‰äº›å‡ºå…¥ã€‚å¹¶æ²¡æœ‰ä¸“é—¨ç”¨äºå…±äº«éå¯è§†é€»è¾‘çš„å†…ç½®é’©å­ï¼Œç›¸åï¼Œä½ å¯ä»¥åˆ›å»ºä¸ä»»ä½• UI è§£è€¦çš„è‡ªå®šä¹‰é’©å­ã€‚</p> <p>é€šè¿‡åˆ›å»ºæˆ‘ä»¬è‡ªå·±è‡ªå®šä¹‰çš„ useRepos é’©å­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ä¸€ç‚¹ã€‚è¿™ä¸ªé’©å­å°†æ¥å—æˆ‘ä»¬æƒ³è¦è·å–çš„ Repos çš„<code>id</code>ï¼Œå¹¶(ä¿ç•™ç±»ä¼¼çš„API)è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œå…¶ä¸­ç¬¬ä¸€é¡¹ä¸ºåŠ è½½çŠ¶æ€ï¼Œç¬¬äºŒé¡¹ä¸º Repos çŠ¶æ€ã€‚</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">useRepos</span> <span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span> repos<span class="token punctuation">,</span> setRepos <span class="token punctuation">]</span> <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span> loading<span class="token punctuation">,</span> setLoading <span class="token punctuation">]</span> <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>

  React<span class="token punctuation">.</span><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setLoading</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>

    <span class="token function">fetchRepos</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">repos</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">setRepos</span><span class="token punctuation">(</span>repos<span class="token punctuation">)</span>
        <span class="token function">setLoading</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token punctuation">[</span> loading<span class="token punctuation">,</span> repos <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>å¥½æ¶ˆæ¯æ˜¯ä»»ä½•ä¸è·å–<code>repos</code>ç›¸å…³çš„é€»è¾‘éƒ½å¯ä»¥åœ¨è¿™ä¸ªè‡ªå®šä¹‰é’©å­ä¸­æŠ½è±¡ã€‚ç°åœ¨ï¼Œä¸ç®¡æˆ‘ä»¬åœ¨å“ªä¸ªç»„ä»¶ä¸­ï¼Œå³ä½¿å®ƒæ˜¯éå¯è§†é€»è¾‘ï¼Œæ¯å½“æˆ‘ä»¬éœ€è¦æœ‰å…³<code>repos</code>çš„æ•°æ®æ—¶ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥ä½¿ç”¨ useRepos è‡ªå®šä¹‰é’©å­ã€‚</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">ReposGrid</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> id <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span> loading<span class="token punctuation">,</span> repos <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useRepos</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>

  <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Profile</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> user <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span> loading<span class="token punctuation">,</span> repos <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useRepos</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>id<span class="token punctuation">)</span>

  <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li>çŠ¶æ€âœ…</li> <li>ç”Ÿå‘½å‘¨æœŸå‡½æ•°âœ…</li> <li>å…±äº«éå¯è§†é€»è¾‘âœ…</li></ul> <h2 id="æ€»ç»“"><a href="#æ€»ç»“" aria-hidden="true" class="header-anchor">#</a> æ€»ç»“</h2> <p>Hooks çš„æ¨å¹¿ç†å¿µæ˜¯ä½ å¯ä»¥åœ¨åŠŸèƒ½ç»„ä»¶ä¸­ä½¿ç”¨çŠ¶æ€ã€‚å®é™…ä¸Šï¼ŒHooks çš„ä½œç”¨è¿œä¸æ­¢äºæ­¤ã€‚æ›´å¤šçš„æ˜¯å…³äºæ”¹è¿›ä»£ç é‡ç”¨ã€ç»„åˆå’Œæ›´å¥½çš„é»˜è®¤è®¾ç½®ã€‚æˆ‘ä»¬è¿˜æœ‰å¾ˆå¤šå…³äº Hooks çš„çŸ¥è¯†éœ€è¦å­¦ä¹ ï¼Œä½†æ˜¯ç°åœ¨ä½ å·²ç»çŸ¥é“äº†å®ƒä»¬å­˜åœ¨çš„åŸå› ï¼Œæˆ‘ä»¬å°±æœ‰äº†ä¸€ä¸ªåšå®çš„åŸºç¡€ã€‚</p> <p><strong>æœ¬æ–‡æ ¹æ®è¯‘è€…ç†è§£ç¿»è¯‘ï¼Œå¦‚æœ‰éœ€è¦ï¼Œè¯·é˜…è¯»åŸæ–‡</strong></p> <h2 id="åŸæ–‡é“¾æ¥"><a href="#åŸæ–‡é“¾æ¥" aria-hidden="true" class="header-anchor">#</a> åŸæ–‡é“¾æ¥</h2> <p><a href="https://dev.to/tylermcginnis/why-react-hooks-51lj" target="_blank" rel="noopener noreferrer">Why React Hooks?<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">ä¸Šæ¬¡æ›´æ–°:</span> <span class="time">8/27/2019, 3:34:23 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/web_blog/blog/Vueç›¸å…³/Vueç®€æ˜“å®ç°.html" class="prev">Vueçš„ç®€æ˜“å®ç°</a></span> <span class="next"><a href="/web_blog/blog/Reactç›¸å…³/Reactä¸­çš„ç”Ÿå‘½å‘¨æœŸ.html">React ä¸­çš„ç”Ÿå‘½å‘¨æœŸ</a>â†’
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/web_blog/assets/js/app.91c2830f.js" defer></script><script src="/web_blog/assets/js/2.eab7b1a3.js" defer></script><script src="/web_blog/assets/js/26.818e6723.js" defer></script>
  </body>
</html>
